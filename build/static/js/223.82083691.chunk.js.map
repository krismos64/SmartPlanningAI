{"version":3,"file":"static/js/223.82083691.chunk.js","mappings":"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","sources":["components/schedule/EmployeeScheduleForm.js","hooks/useHourBalance.js","utils/scheduleUtils.js","components/schedule/WeeklyScheduleGrid.js","components/ui/PageHeader.js","components/ui/Spinner.js","hooks/useWeeklySchedules.js","pages/WeeklySchedule.js"],"sourcesContent":["import PropTypes from \"prop-types\";\nimport { useCallback, useMemo, useState } from \"react\";\nimport { FaSave, FaTimes } from \"react-icons/fa\";\nimport styled, { keyframes } from \"styled-components\";\nimport {\n  calculateHours,\n  formatDate,\n  formatDateForInput,\n  getDaysOfWeek,\n} from \"../../utils/dateUtils\";\nimport Button from \"../ui/Button\";\nimport { FormInput } from \"../ui/Form\";\n\n// Animations\nconst fadeIn = keyframes`\n  from {\n    opacity: 0;\n    transform: translateY(-10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n`;\n\nconst FormContainer = styled.div`\n  background-color: ${({ theme }) => theme.colors.background.primary};\n  color: ${({ theme }) => theme.colors.text.primary};\n  border-radius: 8px;\n  box-shadow: 0 4px 12px\n    ${({ theme }) =>\n      theme.mode === \"dark\" ? \"rgba(0, 0, 0, 0.3)\" : \"rgba(0, 0, 0, 0.1)\"};\n  padding: 1.5rem;\n  margin: 1rem 0;\n  animation: ${fadeIn} 0.3s ease-out;\n  max-width: 100%;\n  overflow-x: auto;\n  transition: background-color 0.2s ease, color 0.2s ease;\n\n  @media (max-width: 768px) {\n    padding: 1rem;\n  }\n`;\n\nconst FormTitle = styled.h3`\n  font-size: 1.25rem;\n  font-weight: 600;\n  margin-bottom: 1.5rem;\n  color: ${({ theme }) => theme.colors.text.primary};\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n\n  @media (max-width: 576px) {\n    flex-direction: column;\n    align-items: flex-start;\n    gap: 0.5rem;\n  }\n`;\n\nconst EmployeeInfo = styled.div`\n  display: flex;\n  flex-direction: column;\n  margin-bottom: 1.5rem;\n  padding-bottom: 1rem;\n  border-bottom: 1px solid ${({ theme }) => theme.colors.border};\n\n  @media (min-width: 768px) {\n    flex-direction: row;\n    align-items: center;\n    justify-content: space-between;\n  }\n`;\n\nconst EmployeeName = styled.div`\n  font-size: 1.1rem;\n  font-weight: 600;\n  margin-bottom: 0.5rem;\n\n  @media (min-width: 768px) {\n    margin-bottom: 0;\n  }\n`;\n\nconst EmployeeDetails = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n  font-size: 0.9rem;\n  color: ${({ theme }) => theme.colors.text.secondary};\n\n  @media (min-width: 768px) {\n    align-items: flex-end;\n  }\n`;\n\nconst DaysGrid = styled.div`\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n  gap: 1rem;\n  margin-bottom: 1.5rem;\n`;\n\nconst DayCard = styled.div`\n  background-color: ${({ $isWeekend, theme }) =>\n    $isWeekend\n      ? theme.colors.background.tertiary\n      : theme.colors.background.secondary};\n  color: ${({ theme }) => theme.colors.text.primary};\n  border: 1px solid ${({ theme }) => theme.colors.border};\n  border-radius: 6px;\n  padding: 1rem;\n  transition: all 0.2s ease;\n\n  &:hover {\n    box-shadow: 0 2px 8px\n      ${({ theme }) =>\n        theme.mode === \"dark\" ? \"rgba(0, 0, 0, 0.3)\" : \"rgba(0, 0, 0, 0.05)\"};\n  }\n`;\n\nconst DayHeader = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 0.75rem;\n  padding-bottom: 0.5rem;\n  border-bottom: 1px solid ${({ theme }) => theme.colors.border};\n`;\n\nconst DayName = styled.div`\n  font-weight: 600;\n  color: ${({ $isWeekend, theme }) =>\n    $isWeekend ? theme.colors.text.secondary : theme.colors.text.primary};\n`;\n\nconst DayDate = styled.div`\n  font-size: 0.85rem;\n  color: ${({ theme }) => theme.colors.text.secondary};\n`;\n\nconst InputGroup = styled.div`\n  margin-bottom: 0.75rem;\n`;\n\nconst InputLabel = styled.label`\n  display: block;\n  font-size: 0.85rem;\n  font-weight: 500;\n  margin-bottom: 0.25rem;\n  color: ${({ theme }) => theme.colors.text.secondary};\n`;\n\nconst ButtonGroup = styled.div`\n  display: flex;\n  gap: 0.5rem;\n\n  @media (max-width: 576px) {\n    width: 100%;\n    justify-content: flex-end;\n  }\n`;\n\nconst ActionButton = styled(Button)`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 0.5rem;\n  transition: all 0.2s ease;\n\n  &:hover {\n    transform: translateY(-2px);\n  }\n`;\n\nconst TotalHours = styled.div`\n  font-size: 1rem;\n  font-weight: 600;\n  margin-top: 1rem;\n  padding-top: 1rem;\n  border-top: 1px solid ${({ theme }) => theme.colors.border};\n  display: flex;\n  justify-content: space-between;\n`;\n\nconst TimeSlotContainer = styled.div`\n  margin-bottom: 0.5rem;\n`;\n\nconst TimeSlot = styled.div`\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  margin-bottom: 0.5rem;\n`;\n\nconst TimeInput = styled(FormInput)`\n  width: 100%;\n  max-width: 120px;\n  background-color: ${({ theme }) => theme.colors.background.input};\n  color: ${({ theme }) => theme.colors.text.primary};\n  border-color: ${({ theme }) => theme.colors.border};\n\n  &:focus {\n    border-color: ${({ theme }) => theme.colors.primary.main};\n    box-shadow: 0 0 0 2px\n      ${({ theme }) =>\n        theme.mode === \"dark\"\n          ? \"rgba(59, 130, 246, 0.3)\"\n          : \"rgba(59, 130, 246, 0.2)\"};\n  }\n`;\n\nconst AddSlotButton = styled(Button)`\n  padding: 0.25rem 0.5rem;\n  font-size: 0.8rem;\n  margin-top: 0.25rem;\n`;\n\nconst RemoveSlotButton = styled(Button)`\n  padding: 0.25rem;\n  font-size: 0.8rem;\n  min-width: auto;\n`;\n\nconst RadioGroup = styled.div`\n  display: flex;\n  gap: 1rem;\n  margin-bottom: 0.75rem;\n`;\n\nconst RadioLabel = styled.label`\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  font-size: 0.9rem;\n  cursor: pointer;\n  color: ${({ theme }) => theme.colors.text.primary};\n`;\n\nconst RadioInput = styled.input`\n  cursor: pointer;\n  accent-color: ${({ theme }) => theme.colors.primary.main};\n`;\n\nconst StyledFormInput = styled(FormInput)`\n  background-color: ${({ theme }) => theme.colors.background.input};\n  color: ${({ theme }) => theme.colors.text.primary};\n  border-color: ${({ theme }) => theme.colors.border};\n\n  &:focus {\n    border-color: ${({ theme }) => theme.colors.primary.main};\n    box-shadow: 0 0 0 2px\n      ${({ theme }) =>\n        theme.mode === \"dark\"\n          ? \"rgba(59, 130, 246, 0.3)\"\n          : \"rgba(59, 130, 246, 0.2)\"};\n  }\n\n  &::placeholder {\n    color: ${({ theme }) => theme.colors.text.placeholder};\n  }\n`;\n\n// Ajouter ce style après les autres styles\nconst WeekInfo = styled.div`\n  font-size: 0.9rem;\n  color: ${({ theme }) => theme.colors.info.dark};\n  background-color: ${({ theme }) => theme.colors.info.light};\n  padding: 0.75rem;\n  border-radius: 4px;\n  margin-bottom: 1rem;\n  border-left: 3px solid ${({ theme }) => theme.colors.info.main};\n`;\n\n// Fonction utilitaire pour convertir les données existantes au nouveau format\nconst convertToNewFormat = (day) => {\n  // Si le jour a déjà le format attendu, le retourner tel quel\n  if (day.type) {\n    return { ...day };\n  }\n\n  // Sinon, convertir au nouveau format\n  return {\n    type: day.absence ? \"absence\" : \"work\",\n    hours: day.hours || \"0\",\n    absence: day.absence || \"\",\n    note: day.note || \"\",\n    timeSlots:\n      day.timeSlots ||\n      (day.hours && parseFloat(day.hours) > 0\n        ? [{ start: \"09:00\", end: \"17:00\" }]\n        : []),\n  };\n};\n\n// Fonction utilitaire pour calculer les heures d'un créneau\nconst calculateDayHours = (timeSlots) => {\n  if (!timeSlots || timeSlots.length === 0) return \"0\";\n\n  let totalHours = 0;\n\n  timeSlots.forEach((slot) => {\n    if (slot.start && slot.end) {\n      const startParts = slot.start.split(\":\").map(Number);\n      const endParts = slot.end.split(\":\").map(Number);\n\n      if (startParts.length === 2 && endParts.length === 2) {\n        const startDate = new Date();\n        startDate.setHours(startParts[0], startParts[1], 0);\n\n        const endDate = new Date();\n        endDate.setHours(endParts[0], endParts[1], 0);\n\n        // Si l'heure de fin est avant l'heure de début, on considère que c'est le jour suivant\n        if (endDate < startDate) {\n          endDate.setDate(endDate.getDate() + 1);\n        }\n\n        const hours = calculateHours(startDate, endDate);\n        totalHours += hours;\n      }\n    }\n  });\n\n  return totalHours.toFixed(1);\n};\n\nconst EmployeeScheduleForm = ({\n  employee,\n  weekStart,\n  scheduleData,\n  onSave,\n  onCancel,\n}) => {\n  // Créer un tableau de jours vides\n  const emptyDays = Array(7)\n    .fill()\n    .map(() => ({\n      type: \"work\",\n      hours: \"0\",\n      absence: \"\",\n      note: \"\",\n      timeSlots: [],\n    }));\n\n  // Initialiser les données du formulaire\n  const initialScheduleData = useMemo(() => {\n    // Si scheduleData est un tableau, l'utiliser directement\n    if (Array.isArray(scheduleData)) {\n      return scheduleData;\n    }\n\n    // Si scheduleData est un objet avec une propriété days, utiliser days\n    if (scheduleData && scheduleData.days && Array.isArray(scheduleData.days)) {\n      return scheduleData.days;\n    }\n\n    // Sinon, utiliser le tableau de jours vides\n    return emptyDays;\n  }, [scheduleData]);\n\n  const [formData, setFormData] = useState(initialScheduleData);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [errors, setErrors] = useState({});\n\n  const weekDays = getDaysOfWeek(weekStart);\n\n  // Vérifier si un jour est un weekend\n  const isWeekend = useCallback((dayIndex) => {\n    return dayIndex === 5 || dayIndex === 6; // Samedi ou Dimanche\n  }, []);\n\n  // Gérer le changement de type (travail ou absence)\n  const handleTypeChange = useCallback((dayIndex, type) => {\n    setFormData((prevFormData) => {\n      const newFormData = [...prevFormData];\n      newFormData[dayIndex] = {\n        ...newFormData[dayIndex],\n        type: type,\n        // Si on passe en mode absence, on vide les créneaux horaires\n        timeSlots: type === \"absence\" ? [] : newFormData[dayIndex].timeSlots,\n        // Si on passe en mode travail, on vide le motif d'absence\n        absence: type === \"work\" ? \"\" : newFormData[dayIndex].absence,\n        // Mettre à jour les heures\n        hours:\n          type === \"absence\"\n            ? \"0\"\n            : calculateDayHours(newFormData[dayIndex].timeSlots),\n      };\n      return newFormData;\n    });\n  }, []);\n\n  // Gérer le changement du motif d'absence\n  const handleAbsenceChange = useCallback((dayIndex, value) => {\n    setFormData((prevFormData) => {\n      const newFormData = [...prevFormData];\n      newFormData[dayIndex] = {\n        ...newFormData[dayIndex],\n        absence: value,\n      };\n      return newFormData;\n    });\n  }, []);\n\n  // Gérer le changement de note\n  const handleNoteChange = useCallback((dayIndex, value) => {\n    setFormData((prevFormData) => {\n      const newFormData = [...prevFormData];\n      newFormData[dayIndex] = {\n        ...newFormData[dayIndex],\n        note: value,\n      };\n      return newFormData;\n    });\n  }, []);\n\n  // Ajouter un créneau horaire\n  const addTimeSlot = useCallback((dayIndex) => {\n    setFormData((prevFormData) => {\n      const newFormData = [...prevFormData];\n      const newTimeSlots = [\n        ...(newFormData[dayIndex].timeSlots || []),\n        { start: \"09:00\", end: \"17:00\" },\n      ];\n\n      newFormData[dayIndex] = {\n        ...newFormData[dayIndex],\n        timeSlots: newTimeSlots,\n        hours: calculateDayHours(newTimeSlots),\n      };\n\n      return newFormData;\n    });\n  }, []);\n\n  // Supprimer un créneau horaire\n  const removeTimeSlot = useCallback((dayIndex, slotIndex) => {\n    setFormData((prevFormData) => {\n      const newFormData = [...prevFormData];\n      const newTimeSlots = [...newFormData[dayIndex].timeSlots];\n      newTimeSlots.splice(slotIndex, 1);\n\n      newFormData[dayIndex] = {\n        ...newFormData[dayIndex],\n        timeSlots: newTimeSlots,\n        hours: calculateDayHours(newTimeSlots),\n      };\n\n      return newFormData;\n    });\n  }, []);\n\n  // Mettre à jour un créneau horaire\n  const updateTimeSlot = useCallback((dayIndex, slotIndex, field, value) => {\n    setFormData((prevFormData) => {\n      const newFormData = [...prevFormData];\n      const newTimeSlots = [...newFormData[dayIndex].timeSlots];\n\n      newTimeSlots[slotIndex] = {\n        ...newTimeSlots[slotIndex],\n        [field]: value,\n      };\n\n      newFormData[dayIndex] = {\n        ...newFormData[dayIndex],\n        timeSlots: newTimeSlots,\n        hours: calculateDayHours(newTimeSlots),\n      };\n\n      return newFormData;\n    });\n  }, []);\n\n  // Calculer le total des heures\n  const calculateTotalHours = useCallback(() => {\n    return formData\n      .reduce((total, day) => total + (parseFloat(day.hours) || 0), 0)\n      .toFixed(1);\n  }, [formData]);\n\n  // Gérer la sauvegarde du planning\n  const handleSave = useCallback(() => {\n    // Convertir le format pour la sauvegarde\n    const formattedSchedule = formData.map((day) => ({\n      hours: day.hours,\n      absence: day.absence,\n      note: day.note,\n      timeSlots: day.timeSlots,\n      type: day.type,\n    }));\n\n    const updatedScheduleData = {\n      employeeId: employee.id,\n      weekStart: formatDateForInput(weekStart),\n      days: formattedSchedule,\n    };\n\n    onSave(updatedScheduleData);\n  }, [employee, onSave, formData, weekStart]);\n\n  if (!employee || !weekDays || formData.length === 0) {\n    return null;\n  }\n\n  return (\n    <FormContainer>\n      <FormTitle>\n        <div>\n          Planning du {formatDate(weekStart)} au {formatDate(weekDays[6])}\n        </div>\n        <ButtonGroup>\n          <ActionButton variant=\"outline\" onClick={onCancel}>\n            <FaTimes /> Annuler\n          </ActionButton>\n          <ActionButton\n            variant=\"primary\"\n            onClick={handleSave}\n            disabled={isSubmitting}\n          >\n            <FaSave /> {isSubmitting ? \"Enregistrement...\" : \"Enregistrer\"}\n          </ActionButton>\n        </ButtonGroup>\n      </FormTitle>\n\n      <EmployeeInfo>\n        <EmployeeName>\n          {employee.first_name} {employee.last_name}\n        </EmployeeName>\n        <EmployeeDetails>\n          <div>Département: {employee.department || \"Non défini\"}</div>\n          <div>Heures contractuelles: {employee.contractHours}h</div>\n        </EmployeeDetails>\n      </EmployeeInfo>\n\n      <WeekInfo>\n        Ce planning est spécifique à la semaine du {formatDate(weekStart)} au{\" \"}\n        {formatDate(weekDays[6])}. Il n'affectera pas les autres semaines.\n      </WeekInfo>\n\n      <DaysGrid>\n        {weekDays.map((day, index) => (\n          <DayCard key={index} $isWeekend={isWeekend(index)}>\n            <DayHeader>\n              <DayName $isWeekend={isWeekend(index)}>\n                {formatDate(day, \"EEEE\")}\n              </DayName>\n              <DayDate>{formatDate(day, \"dd/MM\")}</DayDate>\n            </DayHeader>\n\n            <RadioGroup>\n              <RadioLabel>\n                <RadioInput\n                  type=\"radio\"\n                  name={`day-type-${index}`}\n                  checked={formData[index]?.type === \"work\"}\n                  onChange={() => handleTypeChange(index, \"work\")}\n                />\n                Travail\n              </RadioLabel>\n              <RadioLabel>\n                <RadioInput\n                  type=\"radio\"\n                  name={`day-type-${index}`}\n                  checked={formData[index]?.type === \"absence\"}\n                  onChange={() => handleTypeChange(index, \"absence\")}\n                />\n                Absence\n              </RadioLabel>\n            </RadioGroup>\n\n            {formData[index]?.type === \"work\" ? (\n              <TimeSlotContainer>\n                <InputLabel>\n                  Créneaux horaires ({formData[index]?.hours || \"0\"}h)\n                </InputLabel>\n\n                {formData[index]?.timeSlots?.map((slot, slotIndex) => (\n                  <TimeSlot key={slotIndex}>\n                    <TimeInput\n                      type=\"time\"\n                      value={slot.start}\n                      onChange={(e) =>\n                        updateTimeSlot(\n                          index,\n                          slotIndex,\n                          \"start\",\n                          e.target.value\n                        )\n                      }\n                    />\n                    <span>-</span>\n                    <TimeInput\n                      type=\"time\"\n                      value={slot.end}\n                      onChange={(e) =>\n                        updateTimeSlot(index, slotIndex, \"end\", e.target.value)\n                      }\n                    />\n                    <RemoveSlotButton\n                      variant=\"danger\"\n                      onClick={() => removeTimeSlot(index, slotIndex)}\n                    >\n                      ×\n                    </RemoveSlotButton>\n                  </TimeSlot>\n                ))}\n\n                <AddSlotButton\n                  variant=\"outline\"\n                  onClick={() => addTimeSlot(index)}\n                >\n                  + Ajouter un créneau\n                </AddSlotButton>\n              </TimeSlotContainer>\n            ) : (\n              <InputGroup>\n                <InputLabel>Motif d'absence</InputLabel>\n                <StyledFormInput\n                  type=\"text\"\n                  value={formData[index]?.absence || \"\"}\n                  onChange={(e) => handleAbsenceChange(index, e.target.value)}\n                  placeholder=\"Saisir le motif d'absence...\"\n                />\n              </InputGroup>\n            )}\n\n            <InputGroup>\n              <InputLabel>Note (optionnelle)</InputLabel>\n              <StyledFormInput\n                type=\"text\"\n                value={formData[index]?.note || \"\"}\n                onChange={(e) => handleNoteChange(index, e.target.value)}\n                placeholder=\"Ajouter une note...\"\n              />\n            </InputGroup>\n          </DayCard>\n        ))}\n      </DaysGrid>\n\n      <TotalHours>\n        <span>Total des heures:</span>\n        <span>{calculateTotalHours()}h</span>\n      </TotalHours>\n    </FormContainer>\n  );\n};\n\nEmployeeScheduleForm.propTypes = {\n  employee: PropTypes.object.isRequired,\n  weekStart: PropTypes.instanceOf(Date).isRequired,\n  scheduleData: PropTypes.array,\n  onSave: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired,\n};\n\nexport default EmployeeScheduleForm;\n","import { useCallback, useState } from \"react\";\nimport { toast } from \"react-hot-toast\";\nimport { HourBalanceService } from \"../services/api\";\n\n/**\n * Hook personnalisé pour gérer le solde d'heures des employés\n */\nconst useHourBalance = () => {\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  /**\n   * Récupère le solde d'heures d'un employé\n   * @param {number} employeeId - ID de l'employé\n   * @returns {Promise<Object>} - Solde d'heures de l'employé\n   */\n  const getEmployeeBalance = useCallback(async (employeeId) => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      const result = await HourBalanceService.getByEmployee(employeeId);\n\n      if (!result.success) {\n        console.warn(\n          `Avertissement: Impossible de récupérer le solde d'heures pour l'employé ${employeeId}:`,\n          result.message\n        );\n        return 0; // Retourner 0 par défaut au lieu de lancer une erreur\n      }\n\n      return result.balance;\n    } catch (err) {\n      console.warn(\n        `Avertissement: Erreur lors de la récupération du solde d'heures pour l'employé ${employeeId}:`,\n        err\n      );\n      setError(\n        err.message || \"Erreur lors de la récupération du solde d'heures\"\n      );\n      // Ne pas afficher de toast d'erreur pour ne pas perturber l'utilisateur\n      return 0; // Retourner 0 par défaut\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  /**\n   * Met à jour le solde d'heures d'un employé\n   * @param {number} employeeId - ID de l'employé\n   * @param {Object} balanceData - Données du solde d'heures\n   * @returns {Promise<Object>} - Résultat de la mise à jour\n   */\n  const updateEmployeeBalance = useCallback(async (employeeId, balanceData) => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      const result = await HourBalanceService.updateBalance(\n        employeeId,\n        balanceData\n      );\n\n      if (!result.success) {\n        throw new Error(\n          result.message || \"Erreur lors de la mise à jour du solde d'heures\"\n        );\n      }\n\n      toast.success(\"Solde d'heures mis à jour avec succès\");\n      return { success: true, balance: result.balance };\n    } catch (err) {\n      console.error(\n        `Erreur lors de la mise à jour du solde d'heures pour l'employé ${employeeId}:`,\n        err\n      );\n      setError(\n        err.message || \"Erreur lors de la mise à jour du solde d'heures\"\n      );\n      toast.error(\"Erreur lors de la mise à jour du solde d'heures\");\n      return { success: false, error: err.message };\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  return {\n    loading,\n    error,\n    getEmployeeBalance,\n    updateEmployeeBalance,\n  };\n};\n\nexport default useHourBalance;\n","/**\n * Utilitaires pour la gestion des plannings\n */\n\n// Importer la fonction formatDateForInput\nimport { formatDateForInput } from \"./dateUtils\";\n\n/**\n * Format standard des données de planning\n *\n * Structure:\n * {\n *   employeeId: number,           // ID de l'employé\n *   days: [                       // Tableau de 7 jours (lundi à dimanche)\n *     {\n *       type: string,             // \"work\" ou \"absence\"\n *       hours: string,            // Nombre d'heures travaillées (format \"0.0\")\n *       absence: string,          // Type d'absence (congé, maladie, etc.)\n *       note: string,             // Note ou commentaire\n *       timeSlots: [              // Créneaux horaires\n *         {\n *           start: string,        // Heure de début (format \"HH:MM\")\n *           end: string,          // Heure de fin (format \"HH:MM\")\n *           break: string         // Durée de la pause en heures (optionnel)\n *         }\n *       ]\n *     }\n *   ]\n * }\n */\n\n/**\n * Convertit les anciennes données de planning au format standard\n * @param {Object} schedule - Données de planning à convertir\n * @returns {Object} - Données de planning au format standard\n */\nexport const standardizeScheduleData = (schedule) => {\n  if (!schedule) return null;\n\n  // Si le planning est déjà au format standard, le retourner tel quel\n  if (\n    schedule.days &&\n    Array.isArray(schedule.days) &&\n    schedule.days.length > 0 &&\n    schedule.days[0].type !== undefined\n  ) {\n    return {\n      ...schedule,\n      // S'assurer que weekStart est présent\n      weekStart:\n        schedule.weekStart ||\n        schedule.week_start ||\n        formatDateForInput(new Date()),\n    };\n  }\n\n  // Convertir au format standard\n  return {\n    employeeId: schedule.employeeId || schedule.employee_id,\n    weekStart:\n      schedule.weekStart ||\n      schedule.week_start ||\n      formatDateForInput(new Date()),\n    days: Array.isArray(schedule.days)\n      ? schedule.days.map(convertDayToStandardFormat)\n      : Array(7)\n          .fill()\n          .map(() => createEmptyDay()),\n  };\n};\n\n/**\n * Convertit un jour de planning au format standard\n * @param {Object} day - Jour de planning à convertir\n * @returns {Object} - Jour de planning au format standard\n */\nexport const convertDayToStandardFormat = (day) => {\n  if (!day) return createEmptyDay();\n\n  // Si le jour est déjà au format standard, le retourner tel quel\n  if (day.type) {\n    return { ...day };\n  }\n\n  // Convertir au format standard\n  return {\n    type: day.absence ? \"absence\" : \"work\",\n    hours: day.hours || \"0\",\n    absence: day.absence || \"\",\n    note: day.note || \"\",\n    timeSlots:\n      day.timeSlots ||\n      (day.hours && parseFloat(day.hours) > 0\n        ? [{ start: \"09:00\", end: \"17:00\" }]\n        : []),\n  };\n};\n\n/**\n * Crée un jour de planning vide au format standard\n * @returns {Object} - Jour de planning vide\n */\nexport const createEmptyDay = () => ({\n  type: \"work\",\n  hours: \"0\",\n  absence: \"\",\n  note: \"\",\n  timeSlots: [],\n});\n\n/**\n * Calcule le total des heures pour un planning\n * @param {Object} schedule - Données de planning\n * @returns {number} - Total des heures\n */\nexport const calculateTotalHours = (schedule) => {\n  if (!schedule || !schedule.days) return 0;\n\n  return schedule.days.reduce((total, day) => {\n    return total + (parseFloat(day.hours) || 0);\n  }, 0);\n};\n\n/**\n * Vérifie si un employé est absent pour un jour donné\n * @param {Object} day - Jour de planning\n * @returns {boolean} - True si l'employé est absent\n */\nexport const isAbsent = (day) => {\n  return (\n    day && day.type === \"absence\" && day.absence && day.absence.trim() !== \"\"\n  );\n};\n\n/**\n * Prépare les données de planning pour l'envoi à l'API\n * @param {Object} schedule - Données de planning au format standard\n * @returns {Object} - Données formatées pour l'API\n */\nexport const prepareScheduleForApi = (schedule) => {\n  if (!schedule) return null;\n\n  const standardSchedule = standardizeScheduleData(schedule);\n\n  return {\n    employee_id: standardSchedule.employeeId,\n    week_start: standardSchedule.weekStart,\n    schedule_data: JSON.stringify(standardSchedule.days),\n    total_hours: calculateTotalHours(standardSchedule).toFixed(1),\n  };\n};\n\n/**\n * Analyse les données de planning reçues de l'API\n * @param {Object} apiData - Données reçues de l'API\n * @returns {Object} - Données de planning au format standard\n */\nexport const parseScheduleFromApi = (apiData) => {\n  if (!apiData) return null;\n\n  let days;\n  try {\n    days =\n      typeof apiData.schedule_data === \"string\"\n        ? JSON.parse(apiData.schedule_data)\n        : apiData.schedule_data;\n  } catch (error) {\n    console.error(\"Erreur lors de l'analyse des données de planning:\", error);\n    days = Array(7)\n      .fill()\n      .map(() => createEmptyDay());\n  }\n\n  return {\n    employeeId: apiData.employee_id,\n    days: Array.isArray(days)\n      ? days.map(convertDayToStandardFormat)\n      : Array(7)\n          .fill()\n          .map(() => createEmptyDay()),\n  };\n};\n\nconst scheduleUtils = {\n  standardizeScheduleData,\n  convertDayToStandardFormat,\n  createEmptyDay,\n  calculateTotalHours,\n  isAbsent,\n  prepareScheduleForApi,\n  parseScheduleFromApi,\n};\n\nexport default scheduleUtils;\n","import DOMPurify from \"dompurify\";\nimport html2canvas from \"html2canvas\";\nimport { jsPDF } from \"jspdf\";\nimport PropTypes from \"prop-types\";\nimport { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { toast } from \"react-hot-toast\";\nimport {\n  FaEdit,\n  FaFilePdf,\n  FaSortAmountDown,\n  FaSortAmountUp,\n} from \"react-icons/fa\";\nimport styled, { useTheme } from \"styled-components\";\nimport Button from \"../../components/ui/Button\";\nimport useHourBalance from \"../../hooks/useHourBalance\";\nimport { formatDate, getDayName, getDaysOfWeek } from \"../../utils/dateUtils\";\nimport {\n  calculateTotalHours,\n  isAbsent as isEmployeeAbsent,\n  standardizeScheduleData,\n} from \"../../utils/scheduleUtils\";\n\n// Styles\nconst ScheduleGrid = styled.div`\n  display: grid;\n  grid-template-columns: 250px repeat(7, 1fr) 100px 80px 80px;\n  gap: 1px;\n  background-color: ${({ theme }) => theme.colors.border.light};\n  border-radius: 0.5rem;\n  overflow-x: auto;\n  width: 100%;\n  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1),\n    0 2px 4px -1px rgba(0, 0, 0, 0.06);\n  position: relative;\n\n  &::after {\n    content: \"\";\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    pointer-events: none;\n    background-image: linear-gradient(\n        to right,\n        transparent,\n        transparent 99%,\n        ${({ theme }) => theme.colors.border.light} 99%,\n        ${({ theme }) => theme.colors.border.light} 100%\n      ),\n      linear-gradient(\n        to bottom,\n        transparent,\n        transparent 99%,\n        ${({ theme }) => theme.colors.border.light} 99%,\n        ${({ theme }) => theme.colors.border.light} 100%\n      );\n    background-size: 100% 100%;\n    background-position: 0 0;\n    background-repeat: repeat;\n    z-index: 1;\n  }\n\n  @media (max-width: 1200px) {\n    grid-template-columns: 220px repeat(7, 1fr) 100px 80px 80px;\n  }\n\n  @media (max-width: 992px) {\n    grid-template-columns: 180px repeat(7, minmax(80px, 1fr)) 100px 80px 80px;\n  }\n\n  @media (max-width: 768px) {\n    grid-template-columns: 150px repeat(7, minmax(70px, 1fr)) 100px 80px 80px;\n    font-size: 0.85rem;\n  }\n\n  @media (max-width: 576px) {\n    display: block;\n    overflow-x: visible;\n    background-color: transparent;\n    gap: 0;\n  }\n`;\n\nconst GridCell = styled.div`\n  padding: 0.75rem;\n  background-color: ${({ theme }) => theme.colors.background.primary};\n  color: ${({ theme }) => theme.colors.text.primary};\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  min-height: 50px;\n  transition: all 0.3s ease;\n  position: relative;\n  z-index: 2;\n\n  &:hover {\n    transform: translateZ(0);\n    box-shadow: 0 0 0 1px ${({ theme }) => theme.colors.primary.main}40;\n  }\n\n  @media (max-width: 576px) {\n    padding: 0.5rem;\n    min-height: auto;\n  }\n`;\n\nconst HeaderCell = styled(GridCell)`\n  font-weight: 600;\n  background-color: ${({ theme }) => theme.colors.background.secondary};\n  text-align: center;\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  cursor: ${(props) => (props.sortable ? \"pointer\" : \"default\")};\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 5px;\n\n  &:hover {\n    background-color: ${(props) =>\n      props.sortable\n        ? ({ theme }) => theme.colors.background.tertiary\n        : \"inherit\"};\n  }\n\n  @media (max-width: 576px) {\n    display: none;\n  }\n`;\n\nconst EmployeeCell = styled(GridCell)`\n  justify-content: flex-start;\n  font-weight: 600;\n  position: sticky;\n  left: 0;\n  z-index: 3;\n  box-shadow: 2px 0 5px rgba(0, 0, 0, 0.05);\n  padding: 0.75rem 1rem;\n  min-width: 150px;\n  flex-direction: column;\n  align-items: flex-start;\n`;\n\nconst EmployeeName = styled.div`\n  font-weight: 700;\n  font-size: 1.05rem;\n  margin-bottom: 0.25rem;\n  color: ${({ theme }) => theme.colors.primary.main};\n  display: block;\n  width: 100%;\n  text-align: left;\n`;\n\nconst TotalCell = styled(GridCell)`\n  font-weight: 600;\n  background-color: ${({ theme }) => theme.colors.background.secondary};\n  position: sticky;\n  right: 160px;\n  z-index: 5;\n\n  @media (max-width: 576px) {\n    position: static;\n    border-bottom-left-radius: 0.5rem;\n    border-bottom-right-radius: 0.5rem;\n    margin-bottom: 1rem;\n  }\n`;\n\nconst DayCell = styled(GridCell)`\n  ${({ isWeekend, theme }) =>\n    isWeekend &&\n    `\n    background-color: ${theme.colors.background.tertiary};\n  `}\n\n  ${({ isAbsent }) =>\n    isAbsent &&\n    `\n    color: #ef4444;\n  `}\n  \n  flex-direction: column;\n  gap: 0.25rem;\n  font-size: 0.85rem;\n  text-align: center;\n\n  @media (max-width: 576px) {\n    display: grid;\n    grid-template-columns: 100px 1fr;\n    text-align: left;\n    border-radius: 0;\n    margin: 0;\n\n    &::before {\n      content: attr(data-day);\n      font-weight: 600;\n      color: ${({ theme }) => theme.colors.text.secondary};\n    }\n  }\n`;\n\nconst TimeSlot = styled.div`\n  font-size: 1rem;\n  font-weight: 600;\n  color: ${({ theme }) => theme.colors.text.primary};\n  white-space: nowrap;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n`;\n\nconst BreakInfo = styled.div`\n  font-size: 0.7rem;\n  color: ${({ theme }) => theme.colors.text.tertiary};\n  font-style: italic;\n`;\n\nconst HoursValue = styled.div`\n  font-size: 0.75rem;\n  color: ${({ theme }) => theme.colors.text.secondary};\n`;\n\nconst AbsenceValue = styled.div`\n  font-size: 1.1rem;\n  font-weight: 700;\n  color: #ef4444;\n`;\n\nconst NoteText = styled.div`\n  font-style: italic;\n  font-size: 0.75rem;\n  color: ${({ theme }) => theme.colors.text.secondary};\n  margin-top: 0.25rem;\n  max-width: 100%;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n`;\n\nconst ActionCell = styled(GridCell)`\n  position: sticky;\n  right: 0;\n  z-index: 5;\n  background-color: ${({ theme }) => theme.colors.background.secondary};\n  padding: 0.5rem;\n\n  @media (max-width: 576px) {\n    position: static;\n    padding: 0.5rem;\n  }\n`;\n\nconst ExportCell = styled(GridCell)`\n  position: sticky;\n  right: 80px;\n  z-index: 5;\n  background-color: ${({ theme }) => theme.colors.background.secondary};\n  padding: 0.5rem;\n\n  @media (max-width: 576px) {\n    position: static;\n    padding: 0.5rem;\n  }\n`;\n\nconst EmployeeRow = styled.div`\n  display: contents;\n\n  @media (max-width: 576px) {\n    display: flex;\n    flex-direction: column;\n    border-radius: 0.5rem;\n    overflow: hidden;\n    box-shadow: 0 2px 8px\n      ${({ theme }) =>\n        theme.mode === \"dark\" ? \"rgba(0, 0, 0, 0.3)\" : \"rgba(0, 0, 0, 0.1)\"};\n    margin-bottom: 1.5rem;\n  }\n`;\n\nconst QuickEditButton = styled.button`\n  position: absolute;\n  top: 0.25rem;\n  right: 0.25rem;\n  opacity: 0;\n  padding: 0.25rem;\n  font-size: 0.7rem;\n  background-color: ${({ theme }) => theme.colors.background.secondary};\n  color: ${({ theme }) => theme.colors.text.secondary};\n  border: 1px solid ${({ theme }) => theme.colors.border.main};\n\n  ${DayCell}:hover & {\n    opacity: 1;\n  }\n`;\n\nconst ActionButton = styled(Button)`\n  padding: 0.4rem 0.6rem;\n  font-size: 0.85rem;\n  display: flex;\n  align-items: center;\n  gap: 0.3rem;\n  transition: all 0.2s ease;\n\n  &:hover {\n    transform: translateY(-2px);\n  }\n\n  @media (max-width: 768px) {\n    padding: 0.3rem 0.5rem;\n    font-size: 0.8rem;\n  }\n`;\n\nconst WeeklyScheduleGrid = ({\n  employees,\n  weekStart,\n  scheduleData,\n  onChange,\n  readOnly,\n  onEditEmployee,\n  onGeneratePDF,\n}) => {\n  const theme = useTheme();\n  const { getEmployeeBalance } = useHourBalance();\n\n  // S'assurer que employees est un tableau\n  const employeesArray = Array.isArray(employees) ? employees : [];\n\n  // S'assurer que scheduleData est un tableau\n  const scheduleDataArray = useMemo(() => {\n    return Array.isArray(scheduleData) ? scheduleData : [];\n  }, [scheduleData]);\n\n  // S'assurer que weekStart est une date valide\n  const validWeekStart = useMemo(() => {\n    try {\n      const date = weekStart instanceof Date ? weekStart : new Date(weekStart);\n      return !isNaN(date.getTime()) ? date : new Date();\n    } catch (error) {\n      console.error(\"Date de début de semaine invalide:\", weekStart);\n      return new Date();\n    }\n  }, [weekStart]);\n\n  // État pour le tri\n  const [sortConfig, setSortConfig] = useState({\n    key: null,\n    direction: \"ascending\",\n  });\n\n  // Obtenir les jours de la semaine\n  const daysOfWeek = getDaysOfWeek(validWeekStart);\n\n  // Fonction pour trier les employés\n  const sortedEmployees = [...employeesArray].sort((a, b) => {\n    if (sortConfig.key === null) {\n      return 0;\n    }\n\n    let aValue, bValue;\n\n    if (sortConfig.key === \"name\") {\n      aValue = `${a.lastName} ${a.firstName}`.toLowerCase();\n      bValue = `${b.lastName} ${b.firstName}`.toLowerCase();\n    } else if (sortConfig.key === \"total\") {\n      aValue = parseFloat(calculateEmployeeTotal(a.id));\n      bValue = parseFloat(calculateEmployeeTotal(b.id));\n    } else {\n      aValue = a[sortConfig.key];\n      bValue = b[sortConfig.key];\n    }\n\n    if (aValue < bValue) {\n      return sortConfig.direction === \"ascending\" ? -1 : 1;\n    }\n    if (aValue > bValue) {\n      return sortConfig.direction === \"ascending\" ? 1 : -1;\n    }\n    return 0;\n  });\n\n  // Fonction pour changer le tri\n  const requestSort = useCallback(\n    (key) => {\n      let direction = \"ascending\";\n      if (sortConfig.key === key && sortConfig.direction === \"ascending\") {\n        direction = \"descending\";\n      }\n      setSortConfig({ key, direction });\n    },\n    [sortConfig]\n  );\n\n  // Obtenir l'icône de tri\n  const getSortIcon = useCallback(\n    (key) => {\n      if (sortConfig.key !== key) {\n        return null;\n      }\n      return sortConfig.direction === \"ascending\" ? (\n        <FaSortAmountUp size={12} />\n      ) : (\n        <FaSortAmountDown size={12} />\n      );\n    },\n    [sortConfig]\n  );\n\n  // Trouver le planning d'un employé\n  const findEmployeeSchedule = useCallback(\n    (employeeId) => {\n      const schedule = scheduleDataArray.find(\n        (schedule) => schedule.employeeId === employeeId\n      );\n\n      if (!schedule) {\n        return {\n          employeeId,\n          days: Array(7)\n            .fill()\n            .map(() => ({\n              type: \"work\",\n              hours: \"0\",\n              absence: \"\",\n              note: \"\",\n              timeSlots: [],\n            })),\n        };\n      }\n\n      // Standardiser les données\n      return standardizeScheduleData(schedule);\n    },\n    [scheduleDataArray]\n  );\n\n  // Gérer le clic sur le bouton d'édition\n  const handleEditClick = useCallback(\n    (employeeId) => {\n      if (onEditEmployee) {\n        onEditEmployee(employeeId);\n      }\n    },\n    [onEditEmployee]\n  );\n\n  // Vérifier si un jour est un weekend\n  const isWeekend = useCallback((dayIndex) => {\n    return dayIndex === 5 || dayIndex === 6; // Samedi ou Dimanche\n  }, []);\n\n  // Vérifier si un employé est absent pour un jour donné\n  const isAbsent = useCallback(\n    (employeeId, dayIndex) => {\n      const schedule = findEmployeeSchedule(employeeId);\n      const day = schedule.days[dayIndex];\n      return isEmployeeAbsent(day);\n    },\n    [findEmployeeSchedule]\n  );\n\n  // Formater l'affichage d'une cellule de jour\n  const formatDayCell = useCallback(\n    (employeeId, dayIndex) => {\n      const schedule = findEmployeeSchedule(employeeId);\n      const day = schedule.days[dayIndex];\n\n      if (!day) return null;\n\n      const hasTimeSlots = day.timeSlots && day.timeSlots.length > 0;\n\n      return (\n        <>\n          {day.type === \"absence\" &&\n          day.absence &&\n          day.absence.trim() !== \"\" ? (\n            <AbsenceValue>{day.absence}</AbsenceValue>\n          ) : hasTimeSlots ? (\n            day.timeSlots.map((slot, index) => (\n              <TimeSlot key={index}>\n                {slot.start} - {slot.end}\n                {slot.break && <BreakInfo>Pause: {slot.break}h</BreakInfo>}\n              </TimeSlot>\n            ))\n          ) : (\n            <TimeSlot>-</TimeSlot>\n          )}\n          <HoursValue>{day.hours || \"0\"}h</HoursValue>\n          {day.note && day.note.trim() !== \"\" && (\n            <NoteText title={day.note}>{day.note}</NoteText>\n          )}\n        </>\n      );\n    },\n    [findEmployeeSchedule]\n  );\n\n  // Calculer le total des heures pour un employé\n  const calculateEmployeeTotal = useCallback(\n    (employeeId) => {\n      const schedule = findEmployeeSchedule(employeeId);\n      return calculateTotalHours(schedule).toFixed(1);\n    },\n    [findEmployeeSchedule]\n  );\n\n  // Obtenir le compteur horaire d'un employé (heures contractuelles vs heures travaillées)\n  const getEmployeeHoursCounter = useCallback(\n    (employeeId) => {\n      try {\n        const employee = employees.find((emp) => emp.id === employeeId);\n        if (!employee) return \"N/A\";\n\n        // Vérifier si contractHours existe et est un nombre valide\n        const contractHours = employee.contractHours\n          ? parseFloat(employee.contractHours)\n          : null;\n        if (contractHours === null || isNaN(contractHours)) return \"N/A\";\n\n        // Calculer les heures travaillées\n        const workedHours = parseFloat(calculateEmployeeTotal(employeeId));\n        if (isNaN(workedHours)) return \"N/A\";\n\n        // Utiliser le solde d'heures de l'API si disponible\n        if (employee.hour_balance !== undefined) {\n          const balance = parseFloat(employee.hour_balance);\n          if (!isNaN(balance)) {\n            return balance === 0\n              ? \"0\"\n              : balance > 0\n              ? `+${balance.toFixed(1)}`\n              : balance.toFixed(1);\n          }\n        }\n\n        // Sinon, calculer la différence localement\n        const diff = workedHours - contractHours;\n\n        return diff === 0\n          ? \"0\"\n          : diff > 0\n          ? `+${diff.toFixed(1)}`\n          : diff.toFixed(1);\n      } catch (error) {\n        console.error(\"Erreur lors du calcul du solde d'heures:\", error);\n        return \"N/A\";\n      }\n    },\n    [employees, calculateEmployeeTotal]\n  );\n\n  // Charger le solde d'heures pour chaque employé\n  useEffect(() => {\n    const loadHourBalances = async () => {\n      try {\n        for (const employee of employees) {\n          if (employee && employee.id) {\n            try {\n              const balance = await getEmployeeBalance(employee.id);\n              if (balance !== null) {\n                // Mettre à jour l'employé avec le solde d'heures\n                employee.hour_balance = balance;\n              }\n            } catch (error) {\n              console.warn(\n                `Avertissement: Impossible de récupérer le solde d'heures pour l'employé ${employee.id}:`,\n                error\n              );\n              // Continuer avec les autres employés même si une erreur se produit\n            }\n          }\n        }\n      } catch (error) {\n        console.warn(\n          \"Avertissement lors du chargement des soldes d'heures:\",\n          error\n        );\n        // Ne pas afficher de toast d'erreur pour ne pas perturber l'utilisateur\n      }\n    };\n\n    loadHourBalances();\n  }, [employees, getEmployeeBalance]);\n\n  // Fonction pour générer un PDF du planning d'un employé\n  const generatePDF = (employee, days, weekStart) => {\n    // Vérifier si weekStart est valide\n    if (!weekStart || isNaN(new Date(weekStart).getTime())) {\n      console.error(\n        \"Date de début de semaine invalide pour le PDF:\",\n        weekStart\n      );\n      toast.error(\"Impossible de générer le PDF: date invalide\");\n      return;\n    }\n\n    // Créer un élément temporaire pour le rendu\n    const tempElement = document.createElement(\"div\");\n    tempElement.style.position = \"absolute\";\n    tempElement.style.left = \"-9999px\";\n    tempElement.style.top = \"-9999px\";\n    tempElement.style.width = \"1000px\"; // Plus large pour le format paysage\n\n    // Formater les dates\n    const weekStartDate = new Date(weekStart);\n    const weekEndDate = new Date(weekStart);\n    weekEndDate.setDate(weekEndDate.getDate() + 6);\n\n    const formattedWeekStart = formatDate(weekStartDate);\n    const formattedWeekEnd = formatDate(weekEndDate);\n\n    // Récupérer le prénom et le nom en tenant compte des différentes structures possibles\n    const firstName = employee.firstName || employee.first_name || \"Inconnu\";\n    const lastName = employee.lastName || employee.last_name || \"Inconnu\";\n\n    // Calculer le total des heures\n    const totalHours = days.reduce((sum, day) => {\n      return sum + (day.isAbsent ? 0 : parseFloat(day.hours || 0));\n    }, 0);\n\n    // Créer le contenu HTML\n    const content = `\n      <div style=\"font-family: Arial, sans-serif; padding: 20px; color: #333; text-align: center;\">\n        <h2 style=\"text-align: center; color: #2563eb;\">Planning Hebdomadaire</h2>\n        <h3 style=\"text-align: center; margin-bottom: 10px;\">Du ${formattedWeekStart} au ${formattedWeekEnd}</h3>\n        \n        <div style=\"margin-bottom: 20px; text-align: center;\">\n          <h2 style=\"margin-bottom: 5px; color: #2563eb; font-size: 24px; font-weight: bold;\">${firstName} ${lastName}</h2>\n          <p style=\"margin: 5px 0;\">Poste: ${employee.role || \"Inconnu\"}</p>\n          <p style=\"margin: 5px 0;\">Département: ${\n            employee.department || \"Inconnu\"\n          }</p>\n          <p style=\"margin: 5px 0;\">Heures contractuelles: ${\n            employee.contractHours || \"0\"\n          }h</p>\n          <p style=\"margin: 5px 0;\">Total heures planifiées: ${totalHours.toFixed(\n            1\n          )}h</p>\n        </div>\n        \n        <table style=\"width: 100%; border-collapse: collapse; margin: 0 auto; max-width: 900px;\">\n          <thead>\n            <tr style=\"background-color: #e5e7eb;\">\n              <th style=\"padding: 10px; border: 1px solid #d1d5db; text-align: left;\">Jour</th>\n              <th style=\"padding: 10px; border: 1px solid #d1d5db; text-align: left;\">Heures</th>\n              <th style=\"padding: 10px; border: 1px solid #d1d5db; text-align: left;\">Créneaux</th>\n              <th style=\"padding: 10px; border: 1px solid #d1d5db; text-align: left;\">Notes</th>\n            </tr>\n          </thead>\n          <tbody>\n            ${days\n              .map((day, index) => {\n                const dayDate = new Date(weekStart);\n                dayDate.setDate(dayDate.getDate() + index);\n                const isWeekendDay = isWeekend(dayDate);\n\n                return `\n              <tr style=\"background-color: ${\n                isWeekendDay ? \"#f9fafb\" : \"white\"\n              };\">\n                <td style=\"padding: 10px; border: 1px solid #d1d5db; font-weight: ${\n                  isWeekendDay ? \"bold\" : \"normal\"\n                };\">\n                  ${getDayName(dayDate)} ${formatDate(dayDate, \"dd/MM\")}\n                </td>\n                <td style=\"padding: 10px; border: 1px solid #d1d5db;\">\n                  ${\n                    day.isAbsent\n                      ? `<span style=\"color: #ef4444; font-weight: bold;\">${\n                          day.absenceReason || \"Absent\"\n                        }</span>`\n                      : `${day.hours}h`\n                  }\n                </td>\n                <td style=\"padding: 10px; border: 1px solid #d1d5db;\">\n                  ${\n                    day.isAbsent\n                      ? \"-\"\n                      : (day.timeSlots || [])\n                          .map((slot) => `${slot.start} - ${slot.end}`)\n                          .join(\"<br>\")\n                  }\n                </td>\n                <td style=\"padding: 10px; border: 1px solid #d1d5db; font-style: italic;\">\n                  ${day.notes ? DOMPurify.sanitize(day.notes) : \"\"}\n                </td>\n              </tr>\n              `;\n              })\n              .join(\"\")}\n          </tbody>\n        </table>\n      </div>\n    `;\n\n    // Ajouter le contenu à l'élément temporaire\n    tempElement.innerHTML = DOMPurify.sanitize(content);\n    document.body.appendChild(tempElement);\n\n    // Générer le PDF\n    html2canvas(tempElement, {\n      scale: 1,\n      useCORS: true,\n      logging: false,\n    }).then((canvas) => {\n      const imgData = canvas.toDataURL(\"image/png\");\n      const pdf = new jsPDF(\"l\", \"mm\", \"a4\"); // Format paysage\n      const pdfWidth = pdf.internal.pageSize.getWidth();\n      const ratio = canvas.width / canvas.height;\n      const imgWidth = pdfWidth;\n      const imgHeight = imgWidth / ratio;\n\n      pdf.addImage(imgData, \"PNG\", 0, 0, imgWidth, imgHeight);\n      pdf.save(`Planning_${firstName}_${lastName}_${formattedWeekStart}.pdf`);\n\n      // Nettoyer\n      document.body.removeChild(tempElement);\n    });\n  };\n\n  const handleGeneratePDF = (employee) => {\n    if (onGeneratePDF) {\n      onGeneratePDF(employee);\n      return;\n    }\n\n    // Vérifier si weekStart est une date valide\n    if (!validWeekStart) {\n      console.error(\"Date de début de semaine invalide\");\n      toast.error(\"Impossible de générer le PDF : date invalide\");\n      return;\n    }\n\n    const employeeSchedule = scheduleDataArray.find(\n      (schedule) => schedule.employeeId === employee.id\n    );\n\n    if (employeeSchedule) {\n      // Convertir les jours au format attendu par generatePDF\n      const formattedDays = employeeSchedule.days.map((day) => {\n        return {\n          isAbsent:\n            day.type === \"absence\" && day.absence && day.absence.trim() !== \"\",\n          absenceReason: day.absence || \"\",\n          hours: day.hours || \"0\",\n          timeSlots: day.timeSlots || [],\n          notes: day.note || \"\",\n        };\n      });\n\n      generatePDF(employee, formattedDays, validWeekStart);\n    } else {\n      // Créer un planning vide si aucun n'existe\n      const emptyDays = Array(7)\n        .fill()\n        .map(() => ({\n          isAbsent: false,\n          absenceReason: \"\",\n          hours: \"0\",\n          timeSlots: [],\n          notes: \"\",\n        }));\n      generatePDF(employee, emptyDays, validWeekStart);\n    }\n  };\n\n  // Fonction pour formater la cellule d'employé\n  const formatEmployeeCell = useCallback((employee) => {\n    // Récupérer le prénom et le nom en tenant compte des différentes structures possibles\n    const firstName = employee.firstName || employee.first_name || \"\";\n    const lastName = employee.lastName || employee.last_name || \"\";\n\n    // Vérifiez si les noms sont définis\n    if (!firstName || !lastName) {\n      console.error(\"Nom ou prénom manquant pour l'employé:\", employee);\n    }\n\n    return (\n      <EmployeeName>\n        {firstName} {lastName}\n      </EmployeeName>\n    );\n  }, []);\n\n  return (\n    <ScheduleGrid>\n      {/* En-tête avec les jours de la semaine */}\n      <HeaderCell sortable onClick={() => requestSort(\"name\")}>\n        Employé {getSortIcon(\"name\")}\n      </HeaderCell>\n      {daysOfWeek.map((day, index) => (\n        <HeaderCell key={index}>{formatDate(day, \"EEE dd/MM\")}</HeaderCell>\n      ))}\n      <HeaderCell sortable onClick={() => requestSort(\"total\")}>\n        Heures planifiées {getSortIcon(\"total\")}\n      </HeaderCell>\n      <HeaderCell>Export</HeaderCell>\n      <HeaderCell>Actions</HeaderCell>\n\n      {/* Lignes pour chaque employé */}\n      {sortedEmployees.map((employee) => {\n        return (\n          <EmployeeRow key={employee.id}>\n            <EmployeeCell>{formatEmployeeCell(employee)}</EmployeeCell>\n\n            {/* Cellules pour chaque jour */}\n            {Array(7)\n              .fill()\n              .map((_, dayIndex) => (\n                <DayCell\n                  key={dayIndex}\n                  isWeekend={isWeekend(dayIndex)}\n                  isAbsent={isAbsent(employee.id, dayIndex)}\n                  data-day={formatDate(daysOfWeek[dayIndex], \"EEEE\")}\n                  onClick={() => !readOnly && onEditEmployee(employee.id)}\n                >\n                  {formatDayCell(employee.id, dayIndex)}\n                  {!readOnly && (\n                    <QuickEditButton\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        onEditEmployee(employee.id);\n                      }}\n                    >\n                      <FaEdit />\n                    </QuickEditButton>\n                  )}\n                </DayCell>\n              ))}\n\n            {/* Cellule de total */}\n            <TotalCell>{calculateEmployeeTotal(employee.id)}h</TotalCell>\n\n            {/* Cellule d'export */}\n            <ExportCell>\n              <ActionButton\n                variant=\"secondary\"\n                onClick={() => handleGeneratePDF(employee)}\n              >\n                <FaFilePdf /> PDF\n              </ActionButton>\n            </ExportCell>\n\n            {/* Cellule d'action */}\n            <ActionCell>\n              <ActionButton\n                variant=\"primary\"\n                onClick={() => handleEditClick(employee.id)}\n              >\n                <FaEdit /> Modifier\n              </ActionButton>\n            </ActionCell>\n          </EmployeeRow>\n        );\n      })}\n    </ScheduleGrid>\n  );\n};\n\nWeeklyScheduleGrid.propTypes = {\n  employees: PropTypes.array,\n  weekStart: PropTypes.instanceOf(Date).isRequired,\n  scheduleData: PropTypes.array,\n  onChange: PropTypes.func,\n  readOnly: PropTypes.bool,\n  onEditEmployee: PropTypes.func,\n  onGeneratePDF: PropTypes.func,\n};\n\nWeeklyScheduleGrid.defaultProps = {\n  employees: [],\n  scheduleData: [],\n  onChange: () => {},\n  readOnly: false,\n  onEditEmployee: null,\n  onGeneratePDF: null,\n};\n\nexport default WeeklyScheduleGrid;\n","import PropTypes from \"prop-types\";\nimport styled from \"styled-components\";\n\nconst HeaderContainer = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 2rem;\n  padding-bottom: 1rem;\n  border-bottom: 1px solid ${({ theme }) => theme.colors.border || \"#e0e0e0\"};\n`;\n\nconst Title = styled.h1`\n  font-size: 1.75rem;\n  font-weight: 600;\n  margin: 0;\n  color: ${({ theme }) => theme.colors.text?.primary || \"#333\"};\n`;\n\nconst Description = styled.p`\n  margin: 0.5rem 0 0 0;\n  color: ${({ theme }) => theme.colors.text?.secondary || \"#666\"};\n  font-size: 0.875rem;\n`;\n\nconst ActionsContainer = styled.div`\n  display: flex;\n  gap: 0.75rem;\n`;\n\n/**\n * Composant d'en-tête de page avec titre, description et actions\n */\nconst PageHeader = ({ title, description, actions, children }) => {\n  return (\n    <HeaderContainer>\n      <div>\n        <Title>{title}</Title>\n        {description && <Description>{description}</Description>}\n        {children}\n      </div>\n      {actions && <ActionsContainer>{actions}</ActionsContainer>}\n    </HeaderContainer>\n  );\n};\n\nPageHeader.propTypes = {\n  title: PropTypes.string.isRequired,\n  description: PropTypes.string,\n  actions: PropTypes.node,\n  children: PropTypes.node,\n};\n\nexport default PageHeader;\n","import PropTypes from \"prop-types\";\nimport styled, { keyframes } from \"styled-components\";\n\n// Animation de rotation\nconst rotate = keyframes`\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n`;\n\n// Conteneur du spinner\nconst SpinnerContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: ${({ $center }) => ($center ? \"center\" : \"flex-start\")};\n  height: ${({ $center }) => ($center ? \"100%\" : \"auto\")};\n  width: 100%;\n  padding: 1rem;\n`;\n\n// Élément du spinner\nconst SpinnerElement = styled.div`\n  width: ${({ $size }) => {\n    switch ($size) {\n      case \"small\":\n        return \"1.5rem\";\n      case \"large\":\n        return \"3rem\";\n      default:\n        return \"2rem\";\n    }\n  }};\n  height: ${({ $size }) => {\n    switch ($size) {\n      case \"small\":\n        return \"1.5rem\";\n      case \"large\":\n        return \"3rem\";\n      default:\n        return \"2rem\";\n    }\n  }};\n  border: ${({ $size }) => {\n      switch ($size) {\n        case \"small\":\n          return \"2px\";\n        case \"large\":\n          return \"4px\";\n        default:\n          return \"3px\";\n      }\n    }}\n    solid rgba(0, 0, 0, 0.1);\n  border-top: ${({ $size, theme }) => {\n    const borderWidth =\n      $size === \"small\" ? \"2px\" : $size === \"large\" ? \"4px\" : \"3px\";\n    return `${borderWidth} solid ${theme.colors.primary.main}`;\n  }};\n  border-radius: 50%;\n  animation: ${rotate} 1s linear infinite;\n`;\n\n// Texte du spinner\nconst SpinnerText = styled.p`\n  margin-top: 0.5rem;\n  color: ${({ theme }) => theme.colors.text.secondary};\n  font-size: 0.875rem;\n`;\n\n/**\n * Composant Spinner pour indiquer un chargement\n */\nconst Spinner = ({ $center, $size, text }) => {\n  return (\n    <SpinnerContainer $center={$center}>\n      <SpinnerElement $size={$size} />\n      {text && <SpinnerText>{text}</SpinnerText>}\n    </SpinnerContainer>\n  );\n};\n\nSpinner.propTypes = {\n  $center: PropTypes.bool,\n  $size: PropTypes.oneOf([\"small\", \"medium\", \"large\"]),\n  text: PropTypes.string,\n};\n\nSpinner.defaultProps = {\n  $center: false,\n  $size: \"medium\",\n  text: \"\",\n};\n\nexport default Spinner;\n","import { useCallback, useEffect, useState } from \"react\";\nimport { toast } from \"react-hot-toast\";\nimport { WeeklyScheduleService } from \"../services/api\";\nimport { formatDateForAPI } from \"../utils/dateUtils\";\nimport {\n  parseScheduleFromApi,\n  prepareScheduleForApi,\n  standardizeScheduleData,\n} from \"../utils/scheduleUtils\";\nimport useWebSocket from \"./useWebSocket\";\n\n/**\n * Hook personnalisé pour gérer les plannings hebdomadaires\n */\nconst useWeeklySchedules = () => {\n  const [schedules, setSchedules] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // Intégration WebSocket pour les mises à jour en temps réel\n  const { socket, isConnected, notifyDataChange } = useWebSocket();\n\n  // Écouter les mises à jour WebSocket\n  useEffect(() => {\n    if (socket && isConnected) {\n      // Fonction pour traiter les messages WebSocket\n      const handleWebSocketMessage = (event) => {\n        try {\n          const data = JSON.parse(event.data);\n\n          // Si le message concerne une mise à jour de planning\n          if (data.type === \"SCHEDULE_UPDATED\" && data.schedule) {\n            setSchedules((prevSchedules) => {\n              // Vérifier si le planning existe déjà\n              const exists = prevSchedules.some(\n                (schedule) => schedule.id === data.schedule.id\n              );\n\n              if (exists) {\n                // Mettre à jour le planning existant\n                return prevSchedules.map((schedule) =>\n                  schedule.id === data.schedule.id\n                    ? parseScheduleFromApi(data.schedule)\n                    : schedule\n                );\n              } else {\n                // Ajouter le nouveau planning\n                return [...prevSchedules, parseScheduleFromApi(data.schedule)];\n              }\n            });\n\n            toast.info(\"Planning mis à jour en temps réel\");\n          }\n\n          // Si le message concerne une suppression de planning\n          if (data.type === \"SCHEDULE_DELETED\" && data.scheduleId) {\n            setSchedules((prevSchedules) =>\n              prevSchedules.filter(\n                (schedule) => schedule.id !== data.scheduleId\n              )\n            );\n\n            toast.info(\"Planning supprimé en temps réel\");\n          }\n        } catch (error) {\n          console.error(\n            \"Erreur lors du traitement du message WebSocket:\",\n            error\n          );\n        }\n      };\n\n      // Ajouter l'écouteur d'événements\n      socket.addEventListener(\"message\", handleWebSocketMessage);\n\n      // Nettoyer l'écouteur lors du démontage\n      return () => {\n        socket.removeEventListener(\"message\", handleWebSocketMessage);\n      };\n    }\n  }, [socket, isConnected]);\n\n  /**\n   * Récupère tous les plannings pour une semaine donnée\n   * @param {string} weekStart - Date de début de semaine (format YYYY-MM-DD)\n   * @returns {Promise<Array>} - Liste des plannings\n   */\n  const fetchSchedules = useCallback(async (weekStart) => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      // Vérifier que la date est au bon format\n      if (!weekStart) {\n        throw new Error(\"Date de début de semaine non spécifiée\");\n      }\n\n      // Vérifier que le token d'authentification est présent\n      const token = localStorage.getItem(\"token\");\n      if (!token) {\n        console.error(\"Token d'authentification manquant\");\n        throw new Error(\"Vous devez être connecté pour accéder à ces données\");\n      }\n\n      // S'assurer que la date est au format YYYY-MM-DD\n      let formattedDate = weekStart;\n      if (weekStart instanceof Date) {\n        formattedDate = formatDateForAPI(weekStart);\n      } else if (typeof weekStart === \"string\" && weekStart.includes(\"T\")) {\n        // Si la date contient un T (format ISO), extraire seulement la partie date\n        formattedDate = weekStart.split(\"T\")[0];\n      }\n\n      console.error(\n        \"Tentative de récupération des plannings pour la semaine du:\",\n        formattedDate\n      );\n\n      try {\n        const result = await WeeklyScheduleService.getByWeek(formattedDate);\n\n        if (!result.success) {\n          console.error(\n            \"Échec de la récupération des plannings:\",\n            result.message,\n            result.details || \"\"\n          );\n          throw new Error(\n            result.message || \"Erreur lors du chargement des horaires\"\n          );\n        }\n\n        // Standardiser les données\n        const standardizedSchedules = result.schedules.map((schedule) =>\n          parseScheduleFromApi(schedule)\n        );\n\n        setSchedules(standardizedSchedules);\n        return standardizedSchedules;\n      } catch (apiError) {\n        console.error(\n          \"Erreur API lors de la récupération des plannings:\",\n          apiError\n        );\n        throw apiError;\n      }\n    } catch (err) {\n      console.error(\"Erreur lors du chargement des horaires:\", err);\n      console.error(\"Détails de l'erreur:\", JSON.stringify(err, null, 2));\n      setError(\n        \"Erreur lors du chargement des horaires: \" +\n          (err.message || \"Erreur inconnue\")\n      );\n      toast.error(\"Erreur lors du chargement des horaires\");\n      return [];\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  /**\n   * Crée un nouveau planning\n   * @param {Object} scheduleData - Données du planning\n   * @returns {Promise<Object>} - Résultat de la création\n   */\n  const createSchedule = useCallback(\n    async (scheduleData) => {\n      setLoading(true);\n      try {\n        // Standardiser et préparer les données pour l'API\n        const apiData = prepareScheduleForApi(\n          standardizeScheduleData(scheduleData)\n        );\n\n        const result = await WeeklyScheduleService.create(apiData);\n\n        if (!result.success) {\n          throw new Error(\n            result.message || \"Erreur lors de la création de l'horaire\"\n          );\n        }\n\n        // Ajouter le nouveau planning à la liste\n        const newSchedule = parseScheduleFromApi(result.schedule);\n        setSchedules((prev) => [...prev, newSchedule]);\n\n        // Notifier les autres clients via WebSocket\n        notifyDataChange(\"schedule\", \"create\", newSchedule.id);\n\n        toast.success(\"Planning créé avec succès\");\n        return { success: true, schedule: newSchedule };\n      } catch (error) {\n        console.error(\"Erreur lors de la création du planning:\", error);\n        toast.error(error.message || \"Erreur lors de la création du planning\");\n        return { success: false, error: error.message };\n      }\n    },\n    [notifyDataChange]\n  );\n\n  /**\n   * Met à jour un planning existant\n   * @param {number} id - ID du planning\n   * @param {Object} scheduleData - Données du planning\n   * @returns {Promise<Object>} - Résultat de la mise à jour\n   */\n  const updateSchedule = useCallback(\n    async (id, scheduleData) => {\n      setLoading(true);\n      try {\n        // Standardiser et préparer les données pour l'API\n        const apiData = prepareScheduleForApi(\n          standardizeScheduleData(scheduleData)\n        );\n\n        const result = await WeeklyScheduleService.update(id, apiData);\n\n        if (!result.success) {\n          throw new Error(\n            result.message || \"Erreur lors de la mise à jour de l'horaire\"\n          );\n        }\n\n        // Mettre à jour le planning dans la liste\n        const updatedSchedule = parseScheduleFromApi(result.schedule);\n        setSchedules((prev) =>\n          prev.map((schedule) =>\n            schedule.id === id ? updatedSchedule : schedule\n          )\n        );\n\n        // Notifier les autres clients via WebSocket\n        notifyDataChange(\"schedule\", \"update\", id);\n\n        toast.success(\"Planning mis à jour avec succès\");\n        return { success: true, schedule: updatedSchedule };\n      } catch (error) {\n        console.error(\"Erreur lors de la mise à jour du planning:\", error);\n        toast.error(\n          error.message || \"Erreur lors de la mise à jour du planning\"\n        );\n        return { success: false, error: error.message };\n      }\n    },\n    [notifyDataChange]\n  );\n\n  /**\n   * Supprime un planning\n   * @param {number} id - ID du planning\n   * @returns {Promise<Object>} - Résultat de la suppression\n   */\n  const deleteSchedule = useCallback(\n    async (id) => {\n      setLoading(true);\n      try {\n        const result = await WeeklyScheduleService.delete(id);\n\n        if (!result.success) {\n          throw new Error(\n            result.message || \"Erreur lors de la suppression de l'horaire\"\n          );\n        }\n\n        // Supprimer le planning de la liste\n        setSchedules((prev) => prev.filter((schedule) => schedule.id !== id));\n\n        // Notifier les autres clients via WebSocket\n        notifyDataChange(\"schedule\", \"delete\", id);\n\n        toast.success(\"Planning supprimé avec succès\");\n        return { success: true };\n      } catch (error) {\n        console.error(\"Erreur lors de la suppression du planning:\", error);\n        toast.error(\n          error.message || \"Erreur lors de la suppression du planning\"\n        );\n        return { success: false, error: error.message };\n      }\n    },\n    [notifyDataChange]\n  );\n\n  return {\n    schedules,\n    loading,\n    error,\n    fetchSchedules,\n    createSchedule,\n    updateSchedule,\n    deleteSchedule,\n  };\n};\n\nexport default useWeeklySchedules;\n","import DOMPurify from \"dompurify\";\nimport html2canvas from \"html2canvas\";\nimport { jsPDF } from \"jspdf\";\nimport \"jspdf-autotable\";\nimport { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport { toast } from \"react-hot-toast\";\nimport {\n  FaArrowLeft,\n  FaArrowRight,\n  FaCalendarDay,\n  FaFilePdf,\n  FaUsers,\n} from \"react-icons/fa\";\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport styled from \"styled-components\";\nimport thinkingAnimation from \"../assets/animations/thinking.json\";\nimport EmployeeScheduleForm from \"../components/schedule/EmployeeScheduleForm\";\nimport WeeklyScheduleGrid from \"../components/schedule/WeeklyScheduleGrid\";\nimport Button from \"../components/ui/Button\";\nimport Card, { CardContent, CardHeader } from \"../components/ui/Card\";\nimport { FormInput, FormSelect } from \"../components/ui/Form\";\nimport PageHeader from \"../components/ui/PageHeader\";\nimport Spinner from \"../components/ui/Spinner\";\nimport useEmployees from \"../hooks/useEmployees\";\nimport useWeeklySchedules from \"../hooks/useWeeklySchedules\";\nimport { WeeklyScheduleService } from \"../services/api\";\nimport {\n  addWeeks,\n  formatDate,\n  formatDateForInput,\n  getDayName,\n  getDaysOfWeek,\n  getWeekEnd,\n  getWeekStart,\n  isWeekend,\n} from \"../utils/dateUtils\";\nimport { standardizeScheduleData } from \"../utils/scheduleUtils\";\n\n// Importer react-lottie avec require pour éviter les problèmes de compatibilité\nconst Lottie = require(\"react-lottie\").default;\n\n// Styles\nconst ScheduleContainer = styled.div`\n  padding: 1rem;\n  display: flex;\n  flex-direction: column;\n  gap: 1.5rem;\n\n  @media (min-width: 768px) {\n    padding: 2rem;\n    gap: 2rem;\n  }\n`;\n\nconst ScheduleHeader = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n  margin-bottom: 0.5rem;\n\n  @media (min-width: 768px) {\n    flex-direction: row;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 1rem;\n  }\n`;\n\nconst ScheduleFilters = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n  margin-bottom: 0.75rem;\n\n  @media (min-width: 768px) {\n    flex-direction: row;\n    gap: 1rem;\n    margin-bottom: 1rem;\n  }\n`;\n\nconst WeekNavigation = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n  margin-bottom: 0.75rem;\n\n  @media (min-width: 768px) {\n    flex-direction: row;\n    align-items: center;\n    gap: 1rem;\n    margin-bottom: 1rem;\n  }\n`;\n\nconst WeekActions = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  gap: 0.5rem;\n`;\n\nconst ActionButton = styled(Button)`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 0.5rem;\n  transition: all 0.2s ease;\n\n  &:hover {\n    transform: translateY(-2px);\n  }\n`;\n\nconst ExportAllButton = styled(ActionButton)`\n  margin-left: auto;\n\n  @media (max-width: 768px) {\n    margin-left: 0;\n    width: 100%;\n    margin-top: 0.5rem;\n  }\n`;\n\nconst FilterContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n  width: 100%;\n\n  @media (min-width: 768px) {\n    min-width: 200px;\n    width: auto;\n  }\n`;\n\n/* Composants styled non utilisés - commentés pour éviter les erreurs ESLint\nconst SummaryContainer = styled.div`\n  margin-top: 1rem;\n  padding: 1rem;\n  background-color: #f9fafb;\n  border-radius: 0.5rem;\n`;\n\nconst SummaryTitle = styled.h3`\n  font-size: 1rem;\n  margin-bottom: 0.5rem;\n`;\n\nconst SummaryItem = styled.div`\n  display: flex;\n  justify-content: space-between;\n  padding: 0.5rem 0;\n  border-bottom: 1px solid #e5e7eb;\n\n  &:last-child {\n    border-bottom: none;\n  }\n`;\n\nconst SummaryLabel = styled.span`\n  font-weight: 500;\n`;\n\nconst SummaryValue = styled.span`\n  font-weight: 600;\n  color: ${(props) => (props.isNegative ? \"#ef4444\" : \"#10b981\")};\n`;\n*/\n\nconst FilterSelect = styled(FormSelect)`\n  width: 100%;\n\n  @media (min-width: 768px) {\n    min-width: 200px;\n    width: auto;\n  }\n`;\n\n/* Composant styled non utilisé - commenté pour éviter les erreurs ESLint\nconst CurrentWeek = styled.div`\n  font-size: 1.1rem;\n  font-weight: 600;\n  text-align: center;\n  width: 100%;\n`;\n*/\n\nconst SearchContainer = styled.div`\n  margin-bottom: 1rem;\n  width: 100%;\n`;\n\nconst EmployeeSearchInput = styled(FormInput)`\n  width: 100%;\n`;\n\nconst NoResultsMessage = styled.div`\n  text-align: center;\n  padding: 2rem;\n  color: ${({ theme }) => theme.colors.text.secondary};\n  font-style: italic;\n`;\n\n/* Composant styled non utilisé - commenté pour éviter les erreurs ESLint\nconst ResponsiveButton = styled(Button)`\n  font-size: 0.85rem;\n  padding: 0.5rem 0.75rem;\n\n  @media (min-width: 768px) {\n    font-size: 1rem;\n    padding: 0.5rem 1rem;\n  }\n`;\n*/\n\nconst PlanningTitle = styled.h2`\n  font-size: 1.5rem;\n  font-weight: 700;\n  color: ${({ theme }) => theme.colors.text.primary};\n  margin: 0;\n`;\n\nconst HeaderLeft = styled.div`\n  display: flex;\n  align-items: center;\n  gap: 1.5rem;\n`;\n\nconst AnimationContainer = styled.div`\n  width: 80px;\n  height: 80px;\n  flex-shrink: 0;\n`;\n\nconst TitleContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n`;\n\nconst PageTitle = styled.h1`\n  font-size: 2rem;\n  color: ${({ theme }) => theme.colors.text.primary};\n  margin-bottom: 0.5rem;\n`;\n\nconst PageDescription = styled.p`\n  color: ${({ theme }) => theme.colors.text.secondary};\n  font-size: 1.1rem;\n`;\n\nconst ExportOptions = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n  padding: 1rem;\n  background-color: ${({ theme }) => theme.colors.background.secondary};\n  border-radius: 0.5rem;\n  margin-top: 1rem;\n`;\n\nconst ExportOptionsTitle = styled.h4`\n  font-size: 1rem;\n  font-weight: 600;\n  margin-bottom: 0.5rem;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n`;\n\nconst ExportOptionsGrid = styled.div`\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n  gap: 1rem;\n`;\n\nconst ExportOptionCard = styled.div`\n  padding: 1rem;\n  background-color: ${({ theme }) => theme.colors.background.primary};\n  border-radius: 0.5rem;\n  border: 1px solid ${({ theme }) => theme.colors.border.main};\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n  transition: all 0.2s ease;\n  cursor: pointer;\n\n  &:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1),\n      0 2px 4px -1px rgba(0, 0, 0, 0.06);\n  }\n`;\n\nconst ExportOptionTitle = styled.h5`\n  font-size: 0.9rem;\n  font-weight: 600;\n  margin: 0;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n`;\n\nconst ExportOptionDescription = styled.p`\n  font-size: 0.8rem;\n  color: ${({ theme }) => theme.colors.text.secondary};\n  margin: 0;\n`;\n\n// Ajouter ce style après les autres styles\nconst InfoMessage = styled.div`\n  background-color: ${({ theme }) => theme.colors.info.light};\n  color: ${({ theme }) => theme.colors.info.dark};\n  border-left: 4px solid ${({ theme }) => theme.colors.info.main};\n  padding: 0.75rem 1rem;\n  margin-bottom: 1.5rem;\n  border-radius: 4px;\n  font-size: 0.9rem;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n`;\n\n/**\n * Page de gestion des plannings hebdomadaires\n */\nconst WeeklySchedulePage = () => {\n  const navigate = useNavigate();\n  const { weekStart: weekStartParam } = useParams();\n\n  // Références pour éviter les boucles infinies\n  const prevScheduleDataRef = useRef(null);\n  const prevFormattedScheduleDataRef = useRef(null);\n\n  // États pour la gestion des plannings\n  const [currentWeekStart, setCurrentWeekStart] = useState(() => {\n    try {\n      // Essayer de créer une date à partir de weekStartParam\n      if (weekStartParam) {\n        const date = new Date(weekStartParam);\n        // Vérifier si la date est valide\n        if (!isNaN(date.getTime())) {\n          return date;\n        }\n      }\n      // Si weekStartParam est invalide ou non fourni, utiliser la date actuelle\n      return getWeekStart(new Date());\n    } catch (error) {\n      console.error(\n        \"Erreur lors de l'initialisation de currentWeekStart:\",\n        error\n      );\n      return getWeekStart(new Date());\n    }\n  });\n  const [scheduleData, setScheduleData] = useState([]);\n  const [editingEmployeeId, setEditingEmployeeId] = useState(null);\n  const [selectedDepartment, setSelectedDepartment] = useState(\"\");\n  const [selectedRole, setSelectedRole] = useState(\"\");\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [showExportOptions, setShowExportOptions] = useState(false);\n\n  // Formater la date de début de semaine pour l'API\n  const formattedWeekStart = useMemo(\n    () => formatDateForInput(currentWeekStart),\n    [currentWeekStart]\n  );\n\n  // Récupérer les employés\n  const {\n    employees,\n    loading: employeesLoading,\n    // eslint-disable-next-line no-unused-vars\n    error: employeesError,\n  } = useEmployees();\n\n  // Récupérer les plannings\n  const {\n    schedules,\n    loading: schedulesLoading,\n    error: schedulesError,\n    fetchSchedules,\n    createSchedule,\n    updateSchedule,\n  } = useWeeklySchedules();\n\n  // Formater les données de planning pour le composant WeeklyScheduleGrid\n  const formattedScheduleData = useMemo(() => {\n    if (!schedules || !Array.isArray(schedules)) {\n      console.warn(\"Données de plannings invalides:\", schedules);\n      return [];\n    }\n\n    // Log pour débogage\n\n    // Standardiser les données de planning (incluant la conversion JSON si nécessaire)\n    // La fonction standardizeScheduleData s'assure que les données JSON sont correctement parsées\n    return schedules.map((schedule) => {\n      try {\n        const standardized = standardizeScheduleData(schedule);\n        return standardized;\n      } catch (error) {\n        console.error(\n          `Erreur lors de la standardisation du planning pour l'employé ${schedule.employee_id}:`,\n          error\n        );\n        // Retourner un planning vide en cas d'erreur\n        return {\n          employeeId: schedule.employee_id,\n          days: Array(7)\n            .fill()\n            .map(() => ({\n              type: \"work\",\n              hours: \"0\",\n              absence: \"\",\n              note: \"\",\n              timeSlots: [],\n            })),\n        };\n      }\n    });\n  }, [schedules]);\n\n  // Mettre à jour les données de planning lorsque les plannings changent\n  useEffect(() => {\n    // Vérifier si les données ont changé pour éviter les boucles infinies\n    const currentScheduleDataStr = JSON.stringify(scheduleData);\n    const currentFormattedScheduleDataStr = JSON.stringify(\n      formattedScheduleData\n    );\n\n    if (\n      prevFormattedScheduleDataRef.current !==\n        currentFormattedScheduleDataStr &&\n      prevScheduleDataRef.current !== currentScheduleDataStr\n    ) {\n      prevFormattedScheduleDataRef.current = currentFormattedScheduleDataStr;\n      prevScheduleDataRef.current = currentScheduleDataStr;\n\n      setScheduleData(formattedScheduleData);\n    }\n  }, [formattedScheduleData, scheduleData]);\n\n  // Charger les plannings lorsque la semaine change\n  useEffect(() => {\n    fetchSchedules(formattedWeekStart)\n      .then((data) => {\n        // Mettre à jour l'état local avec les plannings récupérés\n        setScheduleData(data); // Assurez-vous que 'data' contient les plannings\n      })\n      .catch((error) => {\n        console.error(\"Erreur lors de la récupération des plannings:\", error);\n      });\n  }, [fetchSchedules, formattedWeekStart]);\n\n  // Gérer les erreurs de chargement des plannings\n  useEffect(() => {\n    if (schedulesError) {\n      console.error(\"Erreur de chargement des plannings:\", schedulesError);\n      toast.error(`Erreur lors du chargement des plannings: ${schedulesError}`);\n    }\n  }, [schedulesError]);\n\n  // Obtenir l'employé en cours d'édition\n  const editingEmployee = useMemo(() => {\n    if (!editingEmployeeId || !employees) return null;\n    return employees.find((emp) => emp.id === editingEmployeeId) || null;\n  }, [editingEmployeeId, employees]);\n\n  // Extraire les départements uniques\n  const uniqueDepartments = useMemo(() => {\n    if (!employees || !Array.isArray(employees)) return [];\n    const departments = [...new Set(employees.map((emp) => emp.department))];\n    return departments.filter((dept) => dept && dept.trim() !== \"\");\n  }, [employees]);\n\n  // Extraire les rôles uniques\n  const uniqueRoles = useMemo(() => {\n    if (!employees || !Array.isArray(employees)) return [];\n    const roles = [...new Set(employees.map((emp) => emp.role))];\n    return roles.filter((role) => role && role.trim() !== \"\");\n  }, [employees]);\n\n  // Mettre à jour l'URL lorsque la semaine change\n  useEffect(() => {\n    const formattedDate = formatDateForInput(currentWeekStart);\n    navigate(`/weekly-schedule/${formattedDate}`, { replace: true });\n  }, [currentWeekStart, navigate]);\n\n  // Filtrer les employés en fonction des critères\n  const filteredEmployees = useMemo(() => {\n    if (!employees) return [];\n\n    let filtered = Array.isArray(employees) ? [...employees] : [];\n\n    // Filtrer par département si sélectionné\n    if (selectedDepartment) {\n      filtered = filtered.filter(\n        (emp) => emp.department === selectedDepartment\n      );\n    }\n\n    // Filtrer par rôle si sélectionné\n    if (selectedRole) {\n      filtered = filtered.filter((emp) => emp.role === selectedRole);\n    }\n\n    // Filtrer par recherche si saisie\n    if (searchQuery) {\n      const query = searchQuery.toLowerCase();\n      filtered = filtered.filter(\n        (emp) =>\n          emp.firstName.toLowerCase().includes(query) ||\n          emp.lastName.toLowerCase().includes(query) ||\n          (emp.email && emp.email.toLowerCase().includes(query))\n      );\n    }\n\n    return filtered;\n  }, [employees, selectedDepartment, selectedRole, searchQuery]);\n\n  // Fonctions de navigation entre les semaines\n  const goToPreviousWeek = useCallback(() => {\n    setCurrentWeekStart((prev) => addWeeks(prev, -1));\n  }, []);\n\n  const goToNextWeek = useCallback(() => {\n    setCurrentWeekStart((prev) => addWeeks(prev, 1));\n  }, []);\n\n  const goToCurrentWeek = useCallback(() => {\n    setCurrentWeekStart(getWeekStart(new Date()));\n  }, []);\n\n  // Fonction pour gérer l'édition d'un employé\n  const handleEditEmployee = useCallback((employeeId) => {\n    setEditingEmployeeId(employeeId);\n  }, []);\n\n  // Fonction pour annuler l'édition\n  const handleCancelEdit = useCallback(() => {\n    setEditingEmployeeId(null);\n  }, []);\n\n  // Fonction pour gérer la recherche\n  const handleSearchChange = useCallback((e) => {\n    setSearchQuery(e.target.value);\n  }, []);\n\n  // Fonction pour gérer le changement de département\n  const handleDepartmentChange = useCallback((e) => {\n    setSelectedDepartment(e.target.value);\n  }, []);\n\n  // Fonction pour gérer le changement de rôle\n  const handleRoleChange = useCallback((e) => {\n    setSelectedRole(e.target.value);\n  }, []);\n\n  // Fonction pour gérer le changement de planning\n  const handleScheduleChange = useCallback(\n    async (updatedScheduleData) => {\n      try {\n        // S'assurer que la date de début de semaine est correctement définie\n        if (!updatedScheduleData.weekStart) {\n          updatedScheduleData.weekStart = formattedWeekStart;\n        }\n\n        // Si les données mises à jour concernent un seul employé\n        if (updatedScheduleData.employeeId) {\n          // Vérifier si un planning existe déjà pour cet employé et cette semaine spécifique\n          // en utilisant le service getByEmployeeAndWeek\n          const existingScheduleResult =\n            await WeeklyScheduleService.getByEmployeeAndWeek(\n              updatedScheduleData.employeeId,\n              updatedScheduleData.weekStart\n            );\n\n          let result;\n\n          if (\n            existingScheduleResult.success &&\n            existingScheduleResult.schedule\n          ) {\n            // Mettre à jour le planning existant dans la base de données\n            result = await updateSchedule(\n              existingScheduleResult.schedule.id,\n              updatedScheduleData\n            );\n          } else {\n            // Créer un nouveau planning dans la base de données\n            result = await createSchedule(updatedScheduleData);\n          }\n\n          if (result.success) {\n            // Mettre à jour l'état local\n            setScheduleData((prevData) => {\n              const existingIndex = prevData.findIndex(\n                (s) => s.employeeId === updatedScheduleData.employeeId\n              );\n\n              const newData = [...prevData];\n\n              if (existingIndex >= 0) {\n                // Mettre à jour le planning existant\n                newData[existingIndex] = {\n                  ...updatedScheduleData,\n                  id: result.schedule.id, // Ajouter l'ID retourné par l'API\n                };\n              } else {\n                // Ajouter un nouveau planning\n                newData.push({\n                  ...updatedScheduleData,\n                  id: result.schedule.id, // Ajouter l'ID retourné par l'API\n                });\n              }\n\n              return newData;\n            });\n\n            // Fermer le formulaire d'édition\n            setEditingEmployeeId(null);\n\n            // Afficher un message de succès\n            toast.success(\n              \"Planning enregistré avec succès dans la base de données\"\n            );\n          } else {\n            // Afficher un message d'erreur\n            toast.error(\n              result.error || \"Erreur lors de l'enregistrement du planning\"\n            );\n          }\n        } else {\n          // Si c'est un tableau complet de plannings, remplacer tout\n          setScheduleData(updatedScheduleData);\n        }\n      } catch (error) {\n        console.error(\"Erreur lors de l'enregistrement du planning:\", error);\n        toast.error(\"Erreur lors de l'enregistrement du planning\");\n      }\n    },\n    [updateSchedule, createSchedule, formattedWeekStart]\n  );\n\n  // Fonction pour générer un PDF global de tous les employés\n  const generateAllEmployeesPDF = () => {\n    // Filtrer les employés actifs (non absents toute la semaine)\n    const activeEmployees = filteredEmployees.filter((employee) => {\n      const employeeSchedule = scheduleData.find(\n        (s) => s.employeeId === employee.id\n      );\n      if (!employeeSchedule) return true; // Inclure les employés sans planning\n\n      // Vérifier si l'employé est absent toute la semaine\n      const isAbsentAllWeek = employeeSchedule.days.every(\n        (day) =>\n          day.type === \"absence\" && day.absence && day.absence.trim() !== \"\"\n      );\n      return !isAbsentAllWeek;\n    });\n\n    if (activeEmployees.length === 0) {\n      toast.info(\"Aucun employé actif trouvé pour cette semaine\");\n      return;\n    }\n\n    // Créer un élément temporaire pour le rendu\n    const tempElement = document.createElement(\"div\");\n    tempElement.style.position = \"absolute\";\n    tempElement.style.left = \"-9999px\";\n    tempElement.style.top = \"-9999px\";\n    tempElement.style.width = \"1200px\"; // Plus large pour le format paysage\n\n    // Formater les dates\n    const weekStartDate = new Date(currentWeekStart);\n    const weekEndDate = new Date(currentWeekStart);\n    weekEndDate.setDate(weekEndDate.getDate() + 6);\n\n    const formattedWeekStart = formatDate(weekStartDate);\n    const formattedWeekEnd = formatDate(weekEndDate);\n\n    // Créer le contenu HTML\n    const content = `\n      <div style=\"font-family: Arial, sans-serif; padding: 20px; color: #333;\">\n        <h2 style=\"text-align: center; color: #2563eb;\">Planning Hebdomadaire Global</h2>\n        <h3 style=\"text-align: center; margin-bottom: 20px;\">Du ${formattedWeekStart} au ${formattedWeekEnd}</h3>\n        \n        <div style=\"margin-bottom: 20px;\">\n          <p style=\"margin: 5px 0;\">Département: ${\n            selectedDepartment || \"Tous\"\n          }</p>\n          <p style=\"margin: 5px 0;\">Nombre d'employés: ${\n            activeEmployees.length\n          }</p>\n        </div>\n        \n        <table style=\"width: 100%; border-collapse: collapse; margin-top: 20px;\">\n          <thead>\n            <tr style=\"background-color: #e5e7eb;\">\n              <th style=\"padding: 10px; border: 1px solid #d1d5db; text-align: left;\">Employé</th>\n              ${getDaysOfWeek(currentWeekStart)\n                .map(\n                  (day) => `\n                <th style=\"padding: 10px; border: 1px solid #d1d5db; text-align: center; ${\n                  isWeekend(day) ? \"background-color: #f3f4f6;\" : \"\"\n                }\">\n                  ${getDayName(day, true)} ${formatDate(day, \"dd/MM\")}\n                </th>\n              `\n                )\n                .join(\"\")}\n              <th style=\"padding: 10px; border: 1px solid #d1d5db; text-align: center; background-color: #e5e7eb;\">Total</th>\n            </tr>\n          </thead>\n          <tbody>\n            ${activeEmployees\n              .map((employee) => {\n                const employeeSchedule = scheduleData.find(\n                  (s) => s.employeeId === employee.id\n                );\n                const totalHours = employeeSchedule\n                  ? employeeSchedule.days.reduce(\n                      (sum, day) =>\n                        sum +\n                        (day.type === \"absence\"\n                          ? 0\n                          : parseFloat(day.hours || 0)),\n                      0\n                    )\n                  : 0;\n\n                return `\n                <tr>\n                  <td style=\"padding: 10px; border: 1px solid #d1d5db; text-align: left;\">\n                    <strong>${\n                      employee.firstName || employee.first_name || \"Inconnu\"\n                    } ${\n                  employee.lastName || employee.last_name || \"Inconnu\"\n                }</strong><br>\n                    <small>${employee.role || \"Inconnu\"}</small>\n                  </td>\n                  ${getDaysOfWeek(currentWeekStart)\n                    .map((dayDate, index) => {\n                      const isWeekendDay = isWeekend(dayDate);\n\n                      // Récupérer les données du jour pour cet employé\n                      const dayData = employeeSchedule\n                        ? employeeSchedule.days[index]\n                        : null;\n\n                      // Déterminer le contenu de la cellule\n                      let cellContent = \"-\";\n                      if (dayData) {\n                        if (\n                          dayData.type === \"absence\" &&\n                          dayData.absence &&\n                          dayData.absence.trim() !== \"\"\n                        ) {\n                          cellContent = `<span style=\"color: #ef4444;\">${\n                            dayData.absence || \"Absent\"\n                          }</span>`;\n                        } else if (\n                          dayData.timeSlots &&\n                          dayData.timeSlots.length > 0\n                        ) {\n                          cellContent = dayData.timeSlots\n                            .map((slot) => `${slot.start}-${slot.end}`)\n                            .join(\"<br>\");\n\n                          // Ajouter les heures si disponibles\n                          if (dayData.hours) {\n                            cellContent += `<br><small>${dayData.hours}h</small>`;\n                          }\n                        } else if (dayData.hours) {\n                          cellContent = `${dayData.hours}h`;\n                        }\n                      }\n\n                      return `\n                      <td style=\"padding: 8px; border: 1px solid #d1d5db; text-align: center; ${\n                        isWeekendDay ? \"background-color: #f9fafb;\" : \"\"\n                      }\">\n                        ${cellContent}\n                      </td>\n                    `;\n                    })\n                    .join(\"\")}\n                  <td style=\"padding: 10px; border: 1px solid #d1d5db; text-align: center; font-weight: bold;\">\n                    ${totalHours.toFixed(1)}h\n                  </td>\n                </tr>\n              `;\n              })\n              .join(\"\")}\n          </tbody>\n        </table>\n      </div>\n    `;\n\n    // Ajouter le contenu à l'élément temporaire\n    tempElement.innerHTML = DOMPurify.sanitize(content);\n    document.body.appendChild(tempElement);\n\n    // Générer le PDF\n    html2canvas(tempElement, {\n      scale: 1,\n      useCORS: true,\n      logging: false,\n    }).then((canvas) => {\n      const imgData = canvas.toDataURL(\"image/png\");\n      const pdf = new jsPDF(\"l\", \"mm\", \"a4\"); // Format paysage\n      const pdfWidth = pdf.internal.pageSize.getWidth();\n      const ratio = canvas.width / canvas.height;\n      const imgWidth = pdfWidth;\n      const imgHeight = imgWidth / ratio;\n\n      pdf.addImage(imgData, \"PNG\", 0, 0, imgWidth, imgHeight);\n      pdf.save(\n        `Planning_Global_${formatDate(currentWeekStart, \"yyyy-MM-dd\")}.pdf`\n      );\n\n      // Nettoyer\n      document.body.removeChild(tempElement);\n    });\n  };\n\n  // Fonction pour générer un PDF par département\n  const generateDepartmentPDF = (department) => {\n    // Filtrer les employés du département\n    const departmentEmployees = filteredEmployees.filter(\n      (emp) => emp.department === department\n    );\n\n    if (departmentEmployees.length === 0) {\n      toast.info(`Aucun employé trouvé dans le département ${department}`);\n      return;\n    }\n\n    // Créer un élément temporaire pour le rendu\n    const tempElement = document.createElement(\"div\");\n    tempElement.style.position = \"absolute\";\n    tempElement.style.left = \"-9999px\";\n    tempElement.style.top = \"-9999px\";\n    tempElement.style.width = \"1200px\"; // Plus large pour le format paysage\n\n    // Formater les dates\n    const weekStartDate = new Date(currentWeekStart);\n    const weekEndDate = new Date(currentWeekStart);\n    weekEndDate.setDate(weekEndDate.getDate() + 6);\n\n    const formattedWeekStart = formatDate(weekStartDate);\n    const formattedWeekEnd = formatDate(weekEndDate);\n\n    // Créer le contenu HTML\n    const content = `\n      <div style=\"font-family: Arial, sans-serif; padding: 20px; color: #333;\">\n        <h2 style=\"text-align: center; color: #2563eb;\">Planning Hebdomadaire - ${department}</h2>\n        <h3 style=\"text-align: center; margin-bottom: 20px;\">Du ${formattedWeekStart} au ${formattedWeekEnd}</h3>\n        \n        <div style=\"margin-bottom: 20px;\">\n          <p style=\"margin: 5px 0;\">Département: ${department}</p>\n          <p style=\"margin: 5px 0;\">Nombre d'employés: ${\n            departmentEmployees.length\n          }</p>\n        </div>\n        \n        <table style=\"width: 100%; border-collapse: collapse; margin-top: 20px;\">\n          <thead>\n            <tr style=\"background-color: #e5e7eb;\">\n              <th style=\"padding: 10px; border: 1px solid #d1d5db; text-align: left;\">Employé</th>\n              ${getDaysOfWeek(currentWeekStart)\n                .map(\n                  (day) => `\n                <th style=\"padding: 10px; border: 1px solid #d1d5db; text-align: center; ${\n                  isWeekend(day) ? \"background-color: #f3f4f6;\" : \"\"\n                }\">\n                  ${getDayName(day, true)} ${formatDate(day, \"dd/MM\")}\n                </th>\n              `\n                )\n                .join(\"\")}\n              <th style=\"padding: 10px; border: 1px solid #d1d5db; text-align: center; background-color: #e5e7eb;\">Total</th>\n            </tr>\n          </thead>\n          <tbody>\n            ${departmentEmployees\n              .map((employee) => {\n                const employeeSchedule = scheduleData.find(\n                  (s) => s.employeeId === employee.id\n                );\n                const days = employeeSchedule\n                  ? employeeSchedule.days.map((day) => ({\n                      isAbsent:\n                        day.type === \"absence\" &&\n                        day.absence &&\n                        day.absence.trim() !== \"\",\n                      absenceReason: day.absence || \"\",\n                      hours: day.hours || \"0\",\n                      timeSlots: day.timeSlots || [],\n                      notes: day.note || \"\",\n                    }))\n                  : Array(7)\n                      .fill()\n                      .map(() => ({\n                        isAbsent: false,\n                        absenceReason: \"\",\n                        hours: \"0\",\n                        timeSlots: [],\n                        notes: \"\",\n                      }));\n\n                // Calculer le total des heures\n                const totalHours = days.reduce((sum, day) => {\n                  return sum + (day.isAbsent ? 0 : parseFloat(day.hours || 0));\n                }, 0);\n\n                // Déterminer la couleur du total (rouge si < heures contractuelles, vert si >=)\n                const totalColor =\n                  totalHours < employee.contractHours ? \"#ef4444\" : \"#10b981\";\n\n                return `\n                <tr>\n                  <td style=\"padding: 10px; border: 1px solid #d1d5db; font-weight: bold;\">\n                    ${employee.firstName || employee.first_name || \"Inconnu\"} ${\n                  employee.lastName || employee.last_name || \"Inconnu\"\n                }<br>\n                    <span style=\"font-weight: normal; font-size: 0.9em;\">${\n                      employee.role\n                    }</span>\n                  </td>\n                  ${days\n                    .map((day, index) => {\n                      const dayDate = new Date(currentWeekStart);\n                      dayDate.setDate(dayDate.getDate() + index);\n                      const isWeekendDay = isWeekend(dayDate);\n\n                      return `\n                      <td style=\"padding: 8px; border: 1px solid #d1d5db; text-align: center; ${\n                        isWeekendDay ? \"background-color: #f9fafb;\" : \"\"\n                      }\">\n                        ${\n                          day.isAbsent\n                            ? `<span style=\"color: #ef4444; font-weight: bold;\">${\n                                day.absenceReason || \"Absent\"\n                              }</span>`\n                            : `\n                            <div style=\"font-weight: bold; font-size: 1.2em;\">${(\n                              day.timeSlots || []\n                            )\n                              .map((slot) => `${slot.start}-${slot.end}`)\n                              .join(\"<br>\")}</div>\n                            <div style=\"font-size: 0.8em; margin-top: 3px;\">${\n                              day.hours\n                            }h</div>\n                            ${\n                              day.notes\n                                ? `<div style=\"font-style: italic; font-size: 0.8em; color: #6b7280;\">${DOMPurify.sanitize(\n                                    day.notes\n                                  )}</div>`\n                                : \"\"\n                            }\n                          `\n                        }\n                      </td>\n                    `;\n                    })\n                    .join(\"\")}\n                  <td style=\"padding: 10px; border: 1px solid #d1d5db; text-align: center; font-weight: bold; color: ${totalColor};\">\n                    ${totalHours.toFixed(1)}h<br>\n                    <span style=\"font-size: 0.8em; font-weight: normal;\">(${\n                      employee.contractHours\n                    }h)</span>\n                  </td>\n                </tr>\n              `;\n              })\n              .join(\"\")}\n          </tbody>\n        </table>\n      </div>\n    `;\n\n    // Ajouter le contenu à l'élément temporaire\n    tempElement.innerHTML = DOMPurify.sanitize(content);\n    document.body.appendChild(tempElement);\n\n    // Générer le PDF\n    html2canvas(tempElement, {\n      scale: 1,\n      useCORS: true,\n      logging: false,\n    }).then((canvas) => {\n      const imgData = canvas.toDataURL(\"image/png\");\n      const pdf = new jsPDF(\"l\", \"mm\", \"a4\"); // Format paysage\n      const pdfWidth = pdf.internal.pageSize.getWidth();\n      const ratio = canvas.width / canvas.height;\n      const imgWidth = pdfWidth;\n      const imgHeight = imgWidth / ratio;\n\n      pdf.addImage(imgData, \"PNG\", 0, 0, imgWidth, imgHeight);\n      pdf.save(\n        `Planning_${department}_${formatDate(\n          currentWeekStart,\n          \"yyyy-MM-dd\"\n        )}.pdf`\n      );\n\n      // Nettoyer\n      document.body.removeChild(tempElement);\n\n      toast.success(\n        `Planning du département ${department} exporté avec succès`\n      );\n    });\n  };\n\n  // Fonction pour générer un PDF pour un employé spécifique\n  const generateEmployeePDF = (employee) => {\n    if (!employee) {\n      toast.error(\"Employé non trouvé\");\n      return;\n    }\n\n    // Trouver le planning de l'employé\n    const employeeSchedule = scheduleData.find(\n      (s) => s.employeeId === employee.id\n    );\n\n    if (!employeeSchedule) {\n      toast.info(\n        `Aucun planning trouvé pour ${\n          employee.firstName || employee.first_name || \"Inconnu\"\n        } ${employee.lastName || employee.last_name || \"Inconnu\"}`\n      );\n      return;\n    }\n\n    // Convertir les jours au format attendu\n    const formattedDays = employeeSchedule.days.map((day) => {\n      return {\n        isAbsent:\n          day.type === \"absence\" && day.absence && day.absence.trim() !== \"\",\n        absenceReason: day.absence || \"\",\n        hours: day.hours || \"0\",\n        timeSlots: day.timeSlots || [],\n        notes: day.note || \"\",\n      };\n    });\n\n    // Créer un élément temporaire pour le rendu\n    const tempElement = document.createElement(\"div\");\n    tempElement.style.position = \"absolute\";\n    tempElement.style.left = \"-9999px\";\n    tempElement.style.top = \"-9999px\";\n    tempElement.style.width = \"1000px\"; // Plus large pour le format paysage\n\n    // Formater les dates\n    const weekStartDate = new Date(currentWeekStart);\n    const weekEndDate = new Date(currentWeekStart);\n    weekEndDate.setDate(weekEndDate.getDate() + 6);\n\n    const formattedWeekStart = formatDate(weekStartDate);\n    const formattedWeekEnd = formatDate(weekEndDate);\n\n    // Calculer le total des heures\n    const totalHours = formattedDays.reduce((sum, day) => {\n      return sum + (day.isAbsent ? 0 : parseFloat(day.hours || 0));\n    }, 0);\n\n    // Créer le contenu HTML\n    const content = `\n      <div style=\"font-family: Arial, sans-serif; padding: 20px; color: #333; text-align: center;\">\n        <h2 style=\"text-align: center; color: #2563eb;\">Planning Hebdomadaire</h2>\n        <h3 style=\"text-align: center; margin-bottom: 10px;\">Du ${formattedWeekStart} au ${formattedWeekEnd}</h3>\n        \n        <div style=\"margin-bottom: 20px; text-align: center;\">\n          <h2 style=\"margin-bottom: 5px; color: #2563eb; font-size: 24px; font-weight: bold;\">${\n            employee.firstName || employee.first_name || \"Inconnu\"\n          } ${employee.lastName || employee.last_name || \"Inconnu\"}</h2>\n          <p style=\"margin: 5px 0;\">Poste: ${employee.role}</p>\n          <p style=\"margin: 5px 0;\">Département: ${employee.department}</p>\n          <p style=\"margin: 5px 0;\">Heures contractuelles: ${\n            employee.contractHours\n          }h</p>\n          <p style=\"margin: 5px 0;\">Total heures planifiées: ${totalHours.toFixed(\n            1\n          )}h</p>\n        </div>\n        \n        <table style=\"width: 100%; border-collapse: collapse; margin: 0 auto; max-width: 900px;\">\n          <thead>\n            <tr style=\"background-color: #e5e7eb;\">\n              <th style=\"padding: 10px; border: 1px solid #d1d5db; text-align: left;\">Jour</th>\n              <th style=\"padding: 10px; border: 1px solid #d1d5db; text-align: left;\">Heures</th>\n              <th style=\"padding: 10px; border: 1px solid #d1d5db; text-align: left;\">Créneaux</th>\n              <th style=\"padding: 10px; border: 1px solid #d1d5db; text-align: left;\">Notes</th>\n            </tr>\n          </thead>\n          <tbody>\n            ${formattedDays\n              .map((day, index) => {\n                const dayDate = new Date(currentWeekStart);\n                dayDate.setDate(dayDate.getDate() + index);\n                const isWeekendDay = isWeekend(dayDate);\n\n                return `\n                <tr style=\"background-color: ${\n                  isWeekendDay ? \"#f9fafb\" : \"white\"\n                };\">\n                  <td style=\"padding: 10px; border: 1px solid #d1d5db; font-weight: ${\n                    isWeekendDay ? \"bold\" : \"normal\"\n                  };\">\n                    ${getDayName(dayDate)} ${formatDate(dayDate, \"dd/MM\")}\n                  </td>\n                  <td style=\"padding: 10px; border: 1px solid #d1d5db;\">\n                    ${\n                      day.isAbsent\n                        ? `<span style=\"color: #ef4444; font-weight: bold;\">${\n                            day.absenceReason || \"Absent\"\n                          }</span>`\n                        : `${day.hours}h`\n                    }\n                  </td>\n                  <td style=\"padding: 10px; border: 1px solid #d1d5db;\">\n                    ${\n                      day.isAbsent\n                        ? \"-\"\n                        : (day.timeSlots || [])\n                            .map((slot) => `${slot.start} - ${slot.end}`)\n                            .join(\"<br>\")\n                    }\n                  </td>\n                  <td style=\"padding: 10px; border: 1px solid #d1d5db; font-style: italic;\">\n                    ${day.notes || \"-\"}\n                  </td>\n                </tr>\n              `;\n              })\n              .join(\"\")}\n          </tbody>\n        </table>\n      </div>\n    `;\n\n    // Ajouter le contenu à l'élément temporaire\n    tempElement.innerHTML = DOMPurify.sanitize(content);\n    document.body.appendChild(tempElement);\n\n    // Générer le PDF\n    html2canvas(tempElement, {\n      scale: 1,\n      useCORS: true,\n      logging: false,\n    }).then((canvas) => {\n      const imgData = canvas.toDataURL(\"image/png\");\n      const pdf = new jsPDF(\"l\", \"mm\", \"a4\"); // Format paysage\n      const pdfWidth = pdf.internal.pageSize.getWidth();\n      const ratio = canvas.width / canvas.height;\n      const imgWidth = pdfWidth;\n      const imgHeight = imgWidth / ratio;\n\n      pdf.addImage(imgData, \"PNG\", 0, 0, imgWidth, imgHeight);\n      pdf.save(\n        `Planning_${employee.firstName || employee.first_name || \"Inconnu\"}_${\n          employee.lastName || employee.last_name || \"Inconnu\"\n        }_${formatDate(currentWeekStart, \"yyyy-MM-dd\")}.pdf`\n      );\n\n      // Nettoyer\n      document.body.removeChild(tempElement);\n\n      toast.success(\n        `Planning de ${\n          employee.firstName || employee.first_name || \"Inconnu\"\n        } ${\n          employee.lastName || employee.last_name || \"Inconnu\"\n        } exporté avec succès`\n      );\n    });\n  };\n\n  // Ajouter la fonction de gestion de création\n  // eslint-disable-next-line no-unused-vars\n  const handleCreateSchedule = async (formData) => {\n    try {\n      // S'assurer que la date de début de semaine est correctement définie\n      if (!formData.weekStart) {\n        formData.weekStart = formattedWeekStart;\n      }\n\n      const result = await createSchedule(formData);\n      if (result.success) {\n        await fetchSchedules(formData.weekStart);\n        toast.success(\n          \"Planning créé avec succès pour la semaine du \" +\n            formatDate(new Date(formData.weekStart))\n        );\n      } else {\n        toast.error(result.error || \"Erreur lors de la création du planning\");\n      }\n    } catch (error) {\n      console.error(\"Erreur lors de la création du planning:\", error);\n      toast.error(\"Erreur lors de la création du planning\");\n    }\n  };\n\n  // Vérifier si le token d'authentification est présent\n  useEffect(() => {\n    const token = localStorage.getItem(\"token\");\n    console.log(\n      \"Token d'authentification dans WeeklySchedule:\",\n      token ? \"Présent\" : \"Manquant\",\n      token ? `(${token.substring(0, 10)}...)` : \"\"\n    );\n\n    if (!token) {\n      console.error(\"Token d'authentification manquant dans WeeklySchedule\");\n      toast.error(\"Vous devez être connecté pour accéder à cette page\");\n      navigate(\"/login\");\n    }\n  }, [navigate]);\n\n  // Afficher un spinner pendant le chargement\n  if (employeesLoading || schedulesLoading) {\n    return (\n      <Spinner $center={true} $size=\"large\" text=\"Chargement du planning...\" />\n    );\n  }\n\n  return (\n    <div>\n      <PageHeader title=\"Planning Hebdomadaire\" />\n\n      <ScheduleContainer>\n        <ScheduleHeader>\n          <HeaderLeft>\n            <AnimationContainer>\n              <Lottie\n                options={{\n                  loop: true,\n                  autoplay: true,\n                  animationData: thinkingAnimation,\n                  rendererSettings: {\n                    preserveAspectRatio: \"xMidYMid slice\",\n                  },\n                }}\n                height={80}\n                width={80}\n              />\n            </AnimationContainer>\n            <TitleContainer>\n              <PageTitle>Planning Hebdomadaire</PageTitle>\n              <PageDescription>\n                Gérez les horaires de travail de vos employés pour la semaine\n                sélectionnée. Chaque semaine a son propre planning indépendant.\n              </PageDescription>\n            </TitleContainer>\n          </HeaderLeft>\n          <div>\n            <WeekNavigation>\n              <div>\n                <h3>\n                  Semaine du {formatDate(currentWeekStart)} au{\" \"}\n                  {formatDate(getWeekEnd(currentWeekStart))}\n                </h3>\n              </div>\n              <WeekActions>\n                <ActionButton variant=\"outline\" onClick={goToPreviousWeek}>\n                  <FaArrowLeft /> Semaine précédente\n                </ActionButton>\n                <ActionButton variant=\"outline\" onClick={goToCurrentWeek}>\n                  <FaCalendarDay /> Semaine actuelle\n                </ActionButton>\n                <ActionButton variant=\"outline\" onClick={goToNextWeek}>\n                  Semaine suivante <FaArrowRight />\n                </ActionButton>\n                <ExportAllButton\n                  variant=\"secondary\"\n                  onClick={() => setShowExportOptions(!showExportOptions)}\n                >\n                  <FaFilePdf /> Options d'export\n                </ExportAllButton>\n              </WeekActions>\n            </WeekNavigation>\n          </div>\n        </ScheduleHeader>\n\n        <InfoMessage>\n          <strong>Note:</strong> Les plannings sont spécifiques à chaque\n          semaine. Lorsque vous changez de semaine, vous verrez un planning\n          différent. Les modifications apportées à une semaine n'affectent pas\n          les autres semaines.\n        </InfoMessage>\n\n        {!editingEmployeeId && (\n          <>\n            <SearchContainer>\n              <EmployeeSearchInput\n                type=\"text\"\n                placeholder=\"Rechercher un employé par nom, prénom ou email...\"\n                value={searchQuery}\n                onChange={handleSearchChange}\n              />\n            </SearchContainer>\n\n            <ScheduleFilters>\n              <FilterContainer>\n                <FilterSelect\n                  value={selectedDepartment}\n                  onChange={handleDepartmentChange}\n                  placeholder=\"Tous les départements\"\n                >\n                  <option value=\"\">Tous les départements</option>\n                  {uniqueDepartments.map((dept) => (\n                    <option key={dept} value={dept}>\n                      {dept}\n                    </option>\n                  ))}\n                </FilterSelect>\n              </FilterContainer>\n\n              <FilterContainer>\n                <FilterSelect\n                  value={selectedRole}\n                  onChange={handleRoleChange}\n                  placeholder=\"Tous les rôles\"\n                >\n                  <option value=\"\">Tous les rôles</option>\n                  {uniqueRoles.map((role) => (\n                    <option key={role} value={role}>\n                      {role}\n                    </option>\n                  ))}\n                </FilterSelect>\n              </FilterContainer>\n            </ScheduleFilters>\n\n            {showExportOptions && (\n              <ExportOptions>\n                <ExportOptionsTitle>\n                  <FaFilePdf /> Options d'exportation PDF\n                </ExportOptionsTitle>\n                <ExportOptionsGrid>\n                  <ExportOptionCard onClick={generateAllEmployeesPDF}>\n                    <ExportOptionTitle>\n                      <FaUsers /> Planning global\n                    </ExportOptionTitle>\n                    <ExportOptionDescription>\n                      Exporter le planning de tous les employés affichés dans un\n                      seul document PDF\n                    </ExportOptionDescription>\n                  </ExportOptionCard>\n\n                  {uniqueDepartments.map((dept) => (\n                    <ExportOptionCard\n                      key={dept}\n                      onClick={() => generateDepartmentPDF(dept)}\n                    >\n                      <ExportOptionTitle>\n                        <FaUsers /> Département: {dept}\n                      </ExportOptionTitle>\n                      <ExportOptionDescription>\n                        Exporter uniquement le planning des employés du\n                        département {dept}\n                      </ExportOptionDescription>\n                    </ExportOptionCard>\n                  ))}\n                </ExportOptionsGrid>\n              </ExportOptions>\n            )}\n\n            <Card>\n              <CardHeader>\n                <PlanningTitle>\n                  {filteredEmployees.length > 1\n                    ? `Plannings hebdomadaires (${filteredEmployees.length})`\n                    : \"Planning hebdomadaire\"}\n                </PlanningTitle>\n              </CardHeader>\n              <CardContent>\n                {filteredEmployees.length === 0 ? (\n                  <NoResultsMessage>\n                    {searchQuery\n                      ? \"Aucun employé trouvé avec cette recherche.\"\n                      : \"Aucun employé trouvé avec les filtres sélectionnés.\"}\n                  </NoResultsMessage>\n                ) : (\n                  <>\n                    <WeeklyScheduleGrid\n                      employees={filteredEmployees}\n                      weekStart={currentWeekStart}\n                      scheduleData={scheduleData}\n                      onChange={handleScheduleChange}\n                      readOnly={false}\n                      onEditEmployee={handleEditEmployee}\n                      onGeneratePDF={generateEmployeePDF}\n                    />\n                  </>\n                )}\n              </CardContent>\n            </Card>\n          </>\n        )}\n\n        {editingEmployeeId && (\n          <Card>\n            <CardHeader>\n              <div className=\"flex justify-between items-center\">\n                <h2>Modifier le planning</h2>\n                <Button variant=\"secondary\" onClick={handleCancelEdit}>\n                  Annuler\n                </Button>\n              </div>\n            </CardHeader>\n            <CardContent>\n              {editingEmployee && (\n                <EmployeeScheduleForm\n                  employee={editingEmployee}\n                  weekStart={currentWeekStart}\n                  scheduleData={\n                    scheduleData.find(\n                      (s) => s.employeeId === editingEmployeeId\n                    ) || {\n                      employeeId: editingEmployeeId,\n                      days: Array(7)\n                        .fill()\n                        .map(() => ({\n                          type: \"work\",\n                          hours: \"0\",\n                          absence: \"\",\n                          note: \"\",\n                          timeSlots: [],\n                        })),\n                    }\n                  }\n                  onSave={handleScheduleChange}\n                  onCancel={handleCancelEdit}\n                />\n              )}\n            </CardContent>\n          </Card>\n        )}\n      </ScheduleContainer>\n    </div>\n  );\n};\n\nexport default WeeklySchedulePage;\n"],"names":["fadeIn","keyframes","FormContainer","styled","div","_ref","theme","colors","background","primary","_ref2","text","_ref3","mode","FormTitle","h3","_ref4","EmployeeInfo","_ref5","border","EmployeeName","EmployeeDetails","_ref6","secondary","DaysGrid","DayCard","_ref7","$isWeekend","tertiary","_ref8","_ref9","_ref10","DayHeader","_ref11","DayName","_ref12","DayDate","_ref13","InputGroup","InputLabel","label","_ref14","ButtonGroup","ActionButton","Button","TotalHours","_ref15","TimeSlotContainer","TimeSlot","TimeInput","FormInput","_ref16","input","_ref17","_ref18","_ref19","main","_ref20","AddSlotButton","RemoveSlotButton","RadioGroup","RadioLabel","_ref21","RadioInput","_ref22","StyledFormInput","_ref23","_ref24","_ref25","_ref26","_ref27","_ref28","placeholder","WeekInfo","_ref29","info","dark","_ref30","light","_ref31","calculateDayHours","timeSlots","length","totalHours","forEach","slot","start","end","startParts","split","map","Number","endParts","startDate","Date","setHours","endDate","setDate","getDate","hours","calculateHours","toFixed","_ref32","employee","weekStart","scheduleData","onSave","onCancel","emptyDays","Array","fill","type","absence","note","initialScheduleData","useMemo","isArray","days","formData","setFormData","useState","isSubmitting","setIsSubmitting","errors","setErrors","weekDays","getDaysOfWeek","isWeekend","useCallback","dayIndex","handleTypeChange","prevFormData","newFormData","handleAbsenceChange","value","handleNoteChange","addTimeSlot","newTimeSlots","removeTimeSlot","slotIndex","splice","updateTimeSlot","field","calculateTotalHours","reduce","total","day","parseFloat","handleSave","formattedSchedule","updatedScheduleData","employeeId","id","formatDateForInput","_jsxs","children","formatDate","variant","onClick","_jsx","FaTimes","disabled","FaSave","first_name","last_name","department","contractHours","index","_formData$index","_formData$index2","_formData$index3","_formData$index4","_formData$index5","_formData$index5$time","_formData$index6","_formData$index7","name","checked","onChange","e","target","useHourBalance","loading","setLoading","error","setError","getEmployeeBalance","async","result","HourBalanceService","getByEmployee","success","balance","console","warn","message","err","updateEmployeeBalance","balanceData","updateBalance","Error","toast","standardizeScheduleData","schedule","undefined","week_start","employee_id","convertDayToStandardFormat","createEmptyDay","isAbsent","trim","prepareScheduleForApi","standardSchedule","schedule_data","JSON","stringify","total_hours","parseScheduleFromApi","apiData","parse","ScheduleGrid","GridCell","HeaderCell","props","sortable","EmployeeCell","TotalCell","DayCell","BreakInfo","HoursValue","AbsenceValue","NoteText","ActionCell","ExportCell","EmployeeRow","QuickEditButton","button","WeeklyScheduleGrid","employees","readOnly","onEditEmployee","onGeneratePDF","useTheme","employeesArray","scheduleDataArray","validWeekStart","date","isNaN","getTime","sortConfig","setSortConfig","key","direction","daysOfWeek","sortedEmployees","sort","a","b","aValue","bValue","lastName","firstName","toLowerCase","calculateEmployeeTotal","requestSort","getSortIcon","FaSortAmountUp","size","FaSortAmountDown","findEmployeeSchedule","find","handleEditClick","isEmployeeAbsent","formatDayCell","hasTimeSlots","_Fragment","break","title","emp","workedHours","hour_balance","diff","useEffect","loadHourBalances","generatePDF","tempElement","document","createElement","style","position","left","top","width","weekStartDate","weekEndDate","formattedWeekStart","formattedWeekEnd","sum","content","role","dayDate","isWeekendDay","getDayName","absenceReason","join","notes","DOMPurify","sanitize","innerHTML","body","appendChild","html2canvas","scale","useCORS","logging","then","canvas","imgData","toDataURL","pdf","jsPDF","imgWidth","internal","pageSize","getWidth","imgHeight","height","addImage","save","removeChild","formatEmployeeCell","_","stopPropagation","FaEdit","employeeSchedule","formattedDays","handleGeneratePDF","FaFilePdf","defaultProps","HeaderContainer","Title","h1","_theme$colors$text","Description","p","_theme$colors$text2","ActionsContainer","description","actions","rotate","SpinnerContainer","$center","SpinnerElement","$size","SpinnerText","Spinner","useWeeklySchedules","schedules","setSchedules","socket","isConnected","notifyDataChange","useWebSocket","handleWebSocketMessage","event","data","prevSchedules","some","scheduleId","filter","addEventListener","removeEventListener","fetchSchedules","localStorage","getItem","formattedDate","formatDateForAPI","includes","WeeklyScheduleService","getByWeek","details","standardizedSchedules","apiError","createSchedule","create","newSchedule","prev","updateSchedule","update","updatedSchedule","deleteSchedule","delete","Lottie","require","ScheduleContainer","ScheduleHeader","ScheduleFilters","WeekNavigation","WeekActions","ExportAllButton","FilterContainer","FilterSelect","FormSelect","SearchContainer","EmployeeSearchInput","NoResultsMessage","PlanningTitle","h2","HeaderLeft","AnimationContainer","TitleContainer","PageTitle","PageDescription","ExportOptions","ExportOptionsTitle","h4","ExportOptionsGrid","ExportOptionCard","ExportOptionTitle","h5","ExportOptionDescription","InfoMessage","WeeklySchedulePage","navigate","useNavigate","weekStartParam","useParams","prevScheduleDataRef","useRef","prevFormattedScheduleDataRef","currentWeekStart","setCurrentWeekStart","getWeekStart","setScheduleData","editingEmployeeId","setEditingEmployeeId","selectedDepartment","setSelectedDepartment","selectedRole","setSelectedRole","searchQuery","setSearchQuery","showExportOptions","setShowExportOptions","employeesLoading","employeesError","useEmployees","schedulesLoading","schedulesError","formattedScheduleData","currentScheduleDataStr","currentFormattedScheduleDataStr","current","catch","editingEmployee","uniqueDepartments","Set","dept","uniqueRoles","replace","filteredEmployees","filtered","query","email","goToPreviousWeek","addWeeks","goToNextWeek","goToCurrentWeek","handleEditEmployee","handleCancelEdit","handleSearchChange","handleDepartmentChange","handleRoleChange","handleScheduleChange","existingScheduleResult","getByEmployeeAndWeek","prevData","existingIndex","findIndex","s","newData","push","token","log","substring","PageHeader","options","loop","autoplay","animationData","thinkingAnimation","rendererSettings","preserveAspectRatio","getWeekEnd","FaArrowLeft","FaCalendarDay","FaArrowRight","generateAllEmployeesPDF","activeEmployees","every","dayData","cellContent","FaUsers","departmentEmployees","totalColor","generateDepartmentPDF","Card","CardHeader","CardContent","className","EmployeeScheduleForm"],"sourceRoot":""}