"use strict";(self.webpackChunksmartplanning_ai=self.webpackChunksmartplanning_ai||[]).push([[205],{1291:(e,r,t)=>{t.d(r,{AD:()=>f,J4:()=>E,Q$:()=>S,Ww:()=>p,Yq:()=>i,Z1:()=>v,cM:()=>h,rL:()=>m,rm:()=>d,vn:()=>y,w_:()=>g});var o=t(9734),a=t(1620),s=t(8605),n=t(1821),l=t(6981),u=t(2227),c=t(3418);const i=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"dd/MM/yyyy";if(!e)return"";try{const t=e instanceof Date?e:new Date(e);return isNaN(t.getTime())?(console.error("Date invalide dans formatDate:",e),""):(0,o.GP)(t,r,{locale:u.fr})}catch(t){return console.error("Erreur lors du formatage de la date:",t,e),""}},d=e=>e?(0,o.GP)(e,"yyyy-MM-dd"):"",m=e=>(0,a.k)(e,{weekStartsOn:1}),p=e=>(0,s.$)(e,{weekStartsOn:1}),E=(e,r)=>(0,n.J)(e,r),y=e=>{const r=m(e),t=[];for(let o=0;o<7;o++)t.push((0,l.f)(r,o));return t},h=e=>{const r=new Date(e).getDay();return 0===r||6===r},g=(e,r)=>{if(!e||!r)return 0;const t=(r.getTime()-e.getTime())/36e5;return Math.round(10*t)/10},f=function(e){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const t=new Date(e).getDay();return r?["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"][t]:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"][t]},v=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.YX;if(!e)return!1;const t=new Date(e);if(isNaN(t.getTime()))return!1;const o=(e=>{if(!e)return"";const r=new Date(e);return`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}-${String(r.getDate()).padStart(2,"0")}`})(t);return r.some((e=>e.date===o))},w=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.YX;return!h(e)&&!v(e,r)},S=function(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c.YX;if(!e||!r)return 0;const o=new Date(e),a=new Date(r);if(isNaN(o.getTime())||isNaN(a.getTime()))return 0;if(a<o)return 0;let s=0;const n=new Date(o);for(;n<=a;)w(n,t)&&s++,n.setDate(n.getDate()+1);return s}},2479:(e,r,t)=>{t.d(r,{A:()=>l});var o=t(5043),a=t(3768),s=t(4227),n=t(4634);const l=()=>{const[e,r]=(0,o.useState)([]),[t,l]=(0,o.useState)(!0),[u,c]=(0,o.useState)(null),i=(0,n.A)(),d=(0,o.useCallback)((async()=>{t||l(!0);try{const t=await i.get(s.Sn.EMPLOYEES.BASE);var e;if(!t.ok)throw new Error((null===(e=t.data)||void 0===e?void 0:e.message)||"Erreur lors du chargement des employ\xe9s");{const e=Array.isArray(t.data)?t.data:[];r(e),c(null)}}catch(o){console.error("Erreur lors du chargement des employ\xe9s:",o),c("Erreur lors du chargement des employ\xe9s"),a.oR.error("Erreur lors du chargement des employ\xe9s"),r([])}finally{l(!1)}}),[i,t]),m=(0,o.useCallback)((async e=>{l(!0),c(null);try{const t=await i.get(s.Sn.EMPLOYEES.BY_ID(e));if(t.ok)return t.data;var r;throw new Error((null===(r=t.data)||void 0===r?void 0:r.message)||"Erreur lors de la r\xe9cup\xe9ration de l'employ\xe9")}catch(t){return console.error(`Erreur lors de la r\xe9cup\xe9ration de l'employ\xe9 #${e}:`,t),c(t.message||"Erreur lors de la r\xe9cup\xe9ration de l'employ\xe9"),a.oR.error("Erreur lors de la r\xe9cup\xe9ration de l'employ\xe9"),null}finally{l(!1)}}),[i]),p=(0,o.useCallback)((async e=>{try{console.log("Donn\xe9es envoy\xe9es \xe0 l'API pour cr\xe9ation:",e);const o={...e,contractHours:parseFloat(e.contractHours)||35,hourlyRate:parseFloat(e.hourlyRate)||0},a=await i.post(s.Sn.EMPLOYEES.BASE,o);if(console.log("R\xe9ponse de l'API pour cr\xe9ation:",a),!a.ok){var t;const e=(null===(t=a.data)||void 0===t?void 0:t.message)||"Erreur lors de la cr\xe9ation de l'employ\xe9";return console.error("Erreur API:",e),{success:!1,error:e}}return r((e=>[...e,a.data])),{success:!0,employee:a.data}}catch(o){return console.error("Erreur lors de la cr\xe9ation de l'employ\xe9:",o),{success:!1,error:o.message||"Erreur inconnue"}}}),[i]),E=(0,o.useCallback)((async(e,t)=>{try{if(!e)return console.error("ID d'employ\xe9 non valide:",e),{success:!1,error:"ID d'employ\xe9 non valide"};console.log("Donn\xe9es envoy\xe9es \xe0 l'API pour mise \xe0 jour:",t);const a={...t,contractHours:parseFloat(t.contractHours)||35,hourlyRate:parseFloat(t.hourlyRate)||0},n=await i.put(s.Sn.EMPLOYEES.BY_ID(e),a);if(console.log("R\xe9ponse de l'API pour mise \xe0 jour:",n),!n.ok){var o;const e=(null===(o=n.data)||void 0===o?void 0:o.message)||"Erreur lors de la mise \xe0 jour de l'employ\xe9";return console.error("Erreur API:",e),{success:!1,error:e}}return r((r=>r.map((r=>r.id===e?{...r,...n.data}:r)))),{success:!0,employee:n.data}}catch(a){return console.error("Erreur lors de la mise \xe0 jour de l'employ\xe9:",a),{success:!1,error:a.message||"Erreur inconnue"}}}),[i]),y=(0,o.useCallback)((async e=>{try{if(!e)return console.error("ID d'employ\xe9 non valide pour suppression:",e),{success:!1,error:"ID d'employ\xe9 non valide"};console.log("Tentative de suppression de l'employ\xe9 avec ID:",e);const o=await i.delete(s.Sn.EMPLOYEES.BY_ID(e));if(console.log("R\xe9ponse de l'API pour suppression:",o),!o.ok){var t;const e=(null===(t=o.data)||void 0===t?void 0:t.message)||"Erreur lors de la suppression de l'employ\xe9";return console.error("Erreur API:",e),{success:!1,error:e}}return r((r=>r.filter((r=>r.id!==e)))),{success:!0}}catch(o){return console.error("Erreur lors de la suppression de l'employ\xe9:",o),{success:!1,error:o.message||"Erreur inconnue"}}}),[i]),h=(0,o.useCallback)((r=>r&&"all"!==r?e.filter((e=>e.status===r)):e),[e]);return(0,o.useEffect)((()=>{let e=!0,t=0;const o=async()=>{if(t>=3)e&&(c("Erreur lors du chargement des employ\xe9s apr\xe8s plusieurs tentatives"),l(!1));else try{const t=await i.get(s.Sn.EMPLOYEES.BASE);e&&t.ok&&(r(t.data),c(null))}catch(a){if(e)return console.error("Erreur lors du chargement des employ\xe9s:",a),t++,void setTimeout(o,1e3*Math.pow(2,t))}finally{e&&l(!1)}};return o(),()=>{e=!1}}),[i]),{employees:e,loading:t,error:u,fetchEmployees:d,fetchEmployeeById:m,createEmployee:p,updateEmployee:E,deleteEmployee:y,getEmployeesByStatus:h}}},3418:(e,r,t)=>{t.d(r,{YX:()=>s,_z:()=>n,mM:()=>o,y6:()=>a});const o=[{value:"active",label:"Actif"},{value:"pending",label:"En attente"},{value:"inactive",label:"Inactif"}],a=[{value:"paid",label:"Cong\xe9s pay\xe9s",color:"#4CAF50",defaultQuota:25},{value:"rtt",label:"RTT",color:"#2196F3",defaultQuota:11},{value:"unpaid",label:"Cong\xe9s sans solde",color:"#9E9E9E",defaultQuota:null},{value:"sick",label:"Maladie",color:"#F44336",defaultQuota:null},{value:"exceptional",label:"Absence exceptionnelle",color:"#FF9800",defaultQuota:null},{value:"recovery",label:"R\xe9cup\xe9ration",color:"#9C27B0",defaultQuota:null}],s=[{date:"2024-01-01",name:"Jour de l'an"},{date:"2024-04-01",name:"Lundi de P\xe2ques"},{date:"2024-05-01",name:"F\xeate du Travail"},{date:"2024-05-08",name:"Victoire 1945"},{date:"2024-05-09",name:"Ascension"},{date:"2024-05-20",name:"Lundi de Pentec\xf4te"},{date:"2024-07-14",name:"F\xeate Nationale"},{date:"2024-08-15",name:"Assomption"},{date:"2024-11-01",name:"Toussaint"},{date:"2024-11-11",name:"Armistice 1918"},{date:"2024-12-25",name:"No\xebl"}],n=[{id:"name",header:"Nom",accessor:e=>`${e.first_name} ${e.last_name}`,sortable:!0},{id:"email",header:"Email",accessor:e=>e.email,sortable:!0},{id:"department",header:"D\xe9partement",accessor:e=>e.department,sortable:!0},{id:"role",header:"R\xf4le",accessor:e=>e.role,sortable:!0},{id:"status",header:"Statut",accessor:e=>e.status,sortable:!0,type:"status"},{id:"hire_date",header:"Date d'embauche",accessor:e=>{if(!e.hire_date)return"";return new Date(e.hire_date).toLocaleDateString("fr-FR")},sortable:!0,type:"date"},{id:"hourCounter",header:"Compteur d'heures",accessor:e=>{const r=e.contractHours||0;return(e.hoursWorked||0)-r},sortable:!0,type:"number"}]},4634:(e,r,t)=>{t.d(r,{A:()=>n});var o=t(5043),a=t(3768),s=t(4227);const n=()=>{const e=(0,o.useCallback)((async e=>{try{const r={};e.headers.forEach(((e,t)=>{r[t]=e})),console.log("R\xe9ponse du serveur:",{url:e.url,status:e.status,statusText:e.statusText,headers:r});const t=e.headers.get("content-type");let o;if(t&&t.includes("application/json"))o=await e.json();else{const r=await e.text();console.warn("R\xe9ponse non-JSON re\xe7ue:",r),o={message:r}}if(e.ok)return o;{401!==e.status&&403!==e.status||(console.error("Erreur d'authentification:",o),a.oR.error("Session expir\xe9e ou acc\xe8s non autoris\xe9. Veuillez vous reconnecter."),setTimeout((()=>{window.location.href="/login"}),2e3)),500===e.status&&(console.error("Erreur serveur:",o),console.error("URL:",e.url),console.error("M\xe9thode:",e.method),o.error&&console.error("D\xe9tails de l'erreur:",o.error),o.stack&&console.error("Stack trace:",o.stack));const r=o.message||o.error||e.statusText||"Erreur inconnue",t=new Error(r);throw t.status=e.status,t.response={status:e.status,data:o},t}}catch(r){throw console.error("Erreur lors du traitement de la r\xe9ponse:",r),r}}),[]);return(0,o.useMemo)((()=>({get:async r=>{try{console.log(`[API] GET ${r}`);const t=localStorage.getItem("token"),o=await fetch(`${s.H$}${r}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:t?`Bearer ${t}`:""},credentials:"include"}),a=await e(o);return console.log(`[API] GET ${r} Response:`,a),a}catch(t){return console.error(`[API] GET ${r} Error:`,t),{ok:!1,status:0,data:{message:t.message||"Erreur lors de la requ\xeate GET"},headers:new Headers}}},post:async(r,t)=>{try{if(!t||"object"!==typeof t)throw console.error("Donn\xe9es invalides pour la requ\xeate POST:",t),new Error("Donn\xe9es invalides pour la requ\xeate POST");const a={};for(const e in t)a[(o=e,o.replace(/[A-Z]/g,(e=>`_${e.toLowerCase()}`)))]=t[e];const n=localStorage.getItem("token");if(!n)throw console.error("Token d'authentification manquant"),new Error("Vous devez \xeatre connect\xe9 pour effectuer cette action");const l={"Content-Type":"application/json",Authorization:`Bearer ${n}`};console.log("D\xe9tails de la requ\xeate POST:",{endpoint:r,dataSize:JSON.stringify(a).length,headers:{...l,Authorization:"Bearer [MASQU\xc9]"}});const u=new AbortController,c=setTimeout((()=>u.abort()),3e4),i=await fetch(`${s.H$}${r}`,{method:"POST",headers:l,body:JSON.stringify(a),signal:u.signal});return clearTimeout(c),e(i)}catch(a){if("AbortError"===a.name)throw console.error("La requ\xeate a \xe9t\xe9 interrompue (timeout):",a),new Error("La requ\xeate a pris trop de temps, veuillez r\xe9essayer");if(a.message.includes("NetworkError")||a.message.includes("Failed to fetch"))throw console.error("Erreur r\xe9seau lors de la requ\xeate POST:",a),new Error("Probl\xe8me de connexion au serveur, veuillez v\xe9rifier votre connexion internet");throw console.error("Erreur lors de la requ\xeate POST:",a),a}var o},put:async(r,t)=>{try{console.log(`[API] PUT ${r}`,t);const o=localStorage.getItem("token"),a=JSON.parse(JSON.stringify(t)),n=await fetch(`${s.H$}${r}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:o?`Bearer ${o}`:""},body:JSON.stringify(a),credentials:"include"}),l=await e(n);return console.log(`[API] PUT ${r} Response:`,l),l}catch(o){return console.error(`[API] PUT ${r} Error:`,o),{ok:!1,status:0,data:{message:o.message||"Erreur lors de la requ\xeate PUT"},headers:new Headers}}},delete:async r=>{try{console.log(`[API] DELETE ${r}`);const t=localStorage.getItem("token"),o=await fetch(`${s.H$}${r}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:t?`Bearer ${t}`:""},credentials:"include"}),a=await e(o);return console.log(`[API] DELETE ${r} Response:`,a),a}catch(t){return console.error(`[API] DELETE ${r} Error:`,t),{ok:!1,status:0,data:{message:t.message||"Erreur lors de la requ\xeate DELETE"},headers:new Headers}}}})),[e])}}}]);
//# sourceMappingURL=205.6e6e107c.chunk.js.map