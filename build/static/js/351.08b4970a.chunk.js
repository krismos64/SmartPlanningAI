"use strict";(self.webpackChunksmartplanning_ai=self.webpackChunksmartplanning_ai||[]).push([[351],{290:(e,r,o)=>{o.d(r,{A:()=>l});var t=o(5043),n=o(3768),a=o(4583),s=o(4634);const l=()=>{const[e,r]=(0,t.useState)([]),[o,l]=(0,t.useState)(!0),[i,d]=(0,t.useState)(null),c=(0,s.A)(),u=(0,t.useRef)(!0),p=(0,t.useRef)(!1);(0,t.useEffect)((()=>(u.current=!0,p.current=!1,()=>{u.current=!1,p.current=!1})),[]);const m=(0,t.useCallback)((async()=>{if(!p.current&&u.current){p.current=!0,l(!0);try{if(!localStorage.getItem("token"))return d("Vous devez \xeatre connect\xe9 pour acc\xe9der \xe0 ces donn\xe9es"),l(!1),void(p.current=!1);const e=await c.get(a.Sn.VACATIONS);u.current&&(r(e||[]),d(null))}catch(i){console.error("Erreur lors du chargement des cong\xe9s:",i),u.current&&d("Erreur lors du chargement des cong\xe9s. Veuillez r\xe9essayer plus tard.")}finally{u.current&&l(!1),p.current=!1}}}),[c]),x=(0,t.useCallback)((()=>m()),[m]);(0,t.useEffect)((()=>(u.current&&m(),()=>{})),[m]);const h=(0,t.useCallback)((async e=>{if(!u.current)return{success:!1};try{l(!0);const o={...e,status:e.status||"pending"},t=await c.post(a.Sn.VACATIONS,o);return u.current&&(r((e=>[...e,t])),n.oR.success("Demande de cong\xe9 cr\xe9\xe9e avec succ\xe8s"),u.current&&await m()),{success:!0,data:t}}catch(i){var o,t;const r=(null===(o=i.response)||void 0===o||null===(t=o.data)||void 0===t?void 0:t.message)||i.message||"Erreur lors de la cr\xe9ation de la demande de cong\xe9";return u.current&&(n.oR.error(r),d(r)),{success:!1,error:r}}finally{u.current&&l(!1)}}),[c,m]),v=(0,t.useCallback)((async(e,o)=>{if(!u.current)return{success:!1};try{l(!0);const t=await c.put(`${a.Sn.VACATIONS}/${e}`,o);return u.current&&(r((r=>r.map((r=>r.id===e?{...r,...t}:r)))),n.oR.success("Demande de cong\xe9 mise \xe0 jour avec succ\xe8s")),{success:!0,data:t}}catch(i){var t,s;const r=(null===(t=i.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.message)||i.message||"Erreur lors de la mise \xe0 jour de la demande de cong\xe9";return u.current&&(n.oR.error(r),d(r)),{success:!1,error:r}}finally{u.current&&l(!1)}}),[c]),A=(0,t.useCallback)((async e=>{if(!u.current)return{success:!1};try{return l(!0),await c.delete(`${a.Sn.VACATIONS}/${e}`),u.current&&(r((r=>r.filter((r=>r.id!==e)))),n.oR.success("Demande de cong\xe9 supprim\xe9e avec succ\xe8s")),{success:!0}}catch(i){var o,t;const r=(null===(o=i.response)||void 0===o||null===(t=o.data)||void 0===t?void 0:t.message)||i.message||"Erreur lors de la suppression de la demande de cong\xe9";return u.current&&(n.oR.error(r),d(r)),{success:!1,error:r}}finally{u.current&&l(!1)}}),[c]),F=(0,t.useCallback)((async function(e,o){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!u.current)return{success:!1};try{l(!0);const s=await c.put(`${a.Sn.VACATIONS}/${e}/status`,{status:o,comment:t});if(u.current){r((r=>r.map((r=>r.id===e?{...r,...s}:r))));const t="approved"===o?"approuv\xe9e":"rejected"===o?"rejet\xe9e":"mise \xe0 jour";n.oR.success(`Demande de cong\xe9 ${t} avec succ\xe8s`)}return{success:!0,data:s}}catch(i){var s,p;const r=(null===(s=i.response)||void 0===s||null===(p=s.data)||void 0===p?void 0:p.message)||i.message||"Erreur lors de la mise \xe0 jour du statut de la demande de cong\xe9";return u.current&&(n.oR.error(r),d(r)),{success:!1,error:r}}finally{u.current&&l(!1)}}),[c]),g=(0,t.useCallback)((r=>e.filter((e=>e.status===r))),[e]);return{vacations:e,loading:o,error:i,createVacation:h,updateVacation:v,deleteVacation:A,updateVacationStatus:F,getVacationsByStatus:g,refreshVacations:x}}},5351:(e,r,o)=>{o.r(r),o.d(r,{default:()=>ze});var t=o(5903),n=o(1783),a=o(7805),s=o(141),l=o(6946),i=o(4794),d=o(6240),c=o(3600),u=o(622),p=o(8903),m=o(3336),x=o(5865),h=o(3404),v=o(8939),A=o(4056),F=o(1637),g=o(5043),D=o(3768),y=o(3681),j=o(4194),b=o(3216),f=o(579);const C=e=>{let{message:r,onRetry:o,showHomeButton:t=!0}=e;const n=(0,b.Zp)();return(0,f.jsx)(u.A,{maxWidth:"md",sx:{mt:8,mb:8},children:(0,f.jsxs)(m.A,{elevation:3,sx:{p:4,borderRadius:2,display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[(0,f.jsx)(x.A,{variant:"h4",component:"h1",gutterBottom:!0,color:"error",children:"Oups ! Une erreur est survenue"}),(0,f.jsx)(l.A,{sx:{width:"100%",mt:2,mb:4},children:(0,f.jsx)(j.A,{severity:"error",sx:{mb:2},children:r||"Une erreur inattendue s'est produite. Veuillez r\xe9essayer ult\xe9rieurement."})}),(0,f.jsxs)(l.A,{sx:{display:"flex",gap:2,mt:2},children:[o&&(0,f.jsx)(h.A,{variant:"contained",color:"primary",onClick:o,children:"R\xe9essayer"}),t&&(0,f.jsx)(h.A,{variant:"outlined",color:"primary",onClick:()=>{n("/")},children:"Retour \xe0 l'accueil"})]})]})})},k=e=>{let{message:r="Chargement en cours...",size:o=60}=e;return(0,f.jsxs)(u.A,{maxWidth:"xl",sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"50vh",py:8},children:[(0,f.jsx)(F.A,{size:o,thickness:4,color:"primary",sx:{mb:3}}),(0,f.jsxs)(l.A,{sx:{textAlign:"center"},children:[(0,f.jsx)(x.A,{variant:"h6",component:"h2",color:"text.secondary",sx:{animation:"pulse 1.5s infinite ease-in-out","@keyframes pulse":{"0%":{opacity:.6},"50%":{opacity:1},"100%":{opacity:.6}}},children:r}),(0,f.jsx)(x.A,{variant:"body2",color:"text.secondary",sx:{mt:2,maxWidth:500,mx:"auto"},children:"Merci de patienter pendant que nous chargeons vos donn\xe9es..."})]})]})};var B=o(9336);const X=(0,g.memo)((e=>{let{title:r,subtitle:o,icon:t,action:n}=e;const{theme:a}=(0,y.D)(),s="dark"===a;return(0,f.jsxs)(l.A,{sx:{mb:4},children:[(0,f.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1},children:[(0,f.jsxs)(l.A,{sx:{display:"flex",alignItems:"center"},children:[t&&(0,f.jsx)(l.A,{sx:{mr:2,display:"flex",alignItems:"center",justifyContent:"center"},children:t}),(0,f.jsxs)(l.A,{children:[(0,f.jsx)(x.A,{variant:"h4",component:"h1",sx:{fontWeight:"bold",fontSize:{xs:"1.5rem",sm:"2rem",md:"2.25rem"},color:s?"#F9FAFB":"inherit"},children:r}),o&&(0,f.jsx)(x.A,{variant:"subtitle1",color:s?"#D1D5DB":"text.secondary",sx:{mt:.5},children:o})]})]}),n&&(0,f.jsx)(l.A,{sx:{ml:2},children:n})]}),(0,f.jsx)(B.A,{sx:{mt:2,mb:3}})]})}));X.displayName="PageHeader";const S=X;var E=o(9893),I=o(5822),M=o(1214),w=o(9131),$=o(6600),R=o(5316),T=o(9347),z=o(3845),P=o(3193),V=o(1081),O=o(2008),W=o(6258),N=o(4836),_=o(9190),L=o(9285),H=o(7970),U=o(1673),q=o(7784),Y=o(7776),Q=o(6062),G=o(8390),Z=o(4089),J=o(3418),K=o(5016),ee=o(2479),re=o(1734);const oe=(0,t.A)($.A)((e=>{var r,o;let{theme:t}=e;const{theme:n}=(0,y.D)(),a="dark"===(null===t||void 0===t||null===(r=t.palette)||void 0===r?void 0:r.mode)||"dark"===n;return{background:a?(0,i.X4)("#6366F1",.8):(0,i.X4)("#4F46E5",.8),color:"#FFFFFF",borderBottom:"1px solid "+(a?"#374151":"#E5E7EB"),padding:(null===t||void 0===t||null===(o=t.spacing)||void 0===o?void 0:o.call(t,2))||"16px",transition:"all 0.3s ease"}})),te=(0,t.A)(R.A)((e=>{var r,o;let{theme:t}=e;const{theme:n}=(0,y.D)(),a="dark"===(null===t||void 0===t||null===(r=t.palette)||void 0===r?void 0:r.mode)||"dark"===n;return{padding:(null===t||void 0===t||null===(o=t.spacing)||void 0===o?void 0:o.call(t,3))||"24px",background:a?"#1F2937":"#FFFFFF",color:a?"#D1D5DB":"inherit",transition:"all 0.3s ease"}})),ne=(0,t.A)(T.A)((e=>{var r,o;let{theme:t}=e;const{theme:n}=(0,y.D)(),a="dark"===(null===t||void 0===t||null===(r=t.palette)||void 0===r?void 0:r.mode)||"dark"===n;return{borderTop:"1px solid "+(a?"#374151":"#E5E7EB"),padding:(null===t||void 0===t||null===(o=t.spacing)||void 0===o?void 0:o.call(t,2))||"16px",background:a?"#1F2937":"#FFFFFF",transition:"all 0.3s ease"}})),ae=(0,t.A)(z.A)((e=>{var r,o;let{theme:t}=e;const{theme:n}=(0,y.D)(),a="dark"===(null===t||void 0===t||null===(r=t.palette)||void 0===r?void 0:r.mode)||"dark"===n;return{margin:(null===t||void 0===t||null===(o=t.spacing)||void 0===o?void 0:o.call(t,1,0))||"8px 0",background:a?(0,i.X4)("#60A5FA",.2):(0,i.X4)("#3B82F6",.1),color:a?"#93C5FD":"#2563EB",border:a?`1px solid ${(0,i.X4)("#60A5FA",.3)}`:"none",transition:"all 0.3s ease","&:hover":{background:a?(0,i.X4)("#60A5FA",.3):(0,i.X4)("#3B82F6",.2)}}})),se=(0,t.A)(z.A)((e=>{var r,o;let{theme:t}=e;const{theme:n}=(0,y.D)(),a="dark"===(null===t||void 0===t||null===(r=t.palette)||void 0===r?void 0:r.mode)||"dark"===n;return{margin:(null===t||void 0===t||null===(o=t.spacing)||void 0===o?void 0:o.call(t,1,0))||"8px 0",background:a?(0,i.X4)("#F59E0B",.2):(0,i.X4)("#F59E0B",.1),color:a?"#FBBF24":"#D97706",border:a?`1px solid ${(0,i.X4)("#F59E0B",.3)}`:"none",transition:"all 0.3s ease"}})),le=(0,t.A)(P.A)((e=>{var r;let{theme:o}=e;const{theme:t}=(0,y.D)(),n="dark"===(null===o||void 0===o||null===(r=o.palette)||void 0===r?void 0:r.mode)||"dark"===t;return{transition:"all 0.3s ease",transform:"translateZ(0)","& .MuiInputBase-root":{color:n?"#D1D5DB":void 0},"& .MuiInputLabel-root":{color:n?"#9CA3AF":void 0,backgroundColor:n?"#1F2937":"#FFFFFF",padding:"0 8px"},"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:n?"#4B5563":void 0},"&:hover fieldset":{borderColor:n?"#6B7280":void 0},"&.Mui-focused fieldset":{borderColor:n?"#6366F1":void 0}},"& .MuiMenuItem-root":{color:n?"#D1D5DB":void 0},"&:hover":{transform:"translateY(-2px)",boxShadow:n?`0 4px 8px ${(0,i.X4)("#000",.3)}`:`0 4px 8px ${(0,i.X4)("#000",.1)}`}}})),ie=e=>{var r;let{open:o,onClose:t,onSubmit:n,vacation:a,currentUser:s}=e;const{user:c}=(0,K.A)(),{employees:u,loading:m}=(0,ee.A)(),v=(0,d.A)(),{theme:A}=(0,y.D)(),F="dark"===(null===v||void 0===v||null===(r=v.palette)||void 0===r?void 0:r.mode)||"dark"===A,[D,j]=(0,g.useState)({employeeId:"",startDate:null,endDate:null,type:"paid",reason:""}),[b,C]=(0,g.useState)({}),[k,B]=(0,g.useState)(0),[X,S]=(0,g.useState)(!1),[$,R]=(0,g.useState)(!1);(0,g.useEffect)((()=>{c&&"admin"===c.role?R(!0):R(!1)}),[c]),(0,g.useEffect)((()=>{j(a?{employeeId:a.employeeId||"",startDate:a.startDate?new Date(a.startDate):null,endDate:a.endDate?new Date(a.endDate):null,type:a.type||"paid",reason:a.reason||""}:{employeeId:(null===s||void 0===s?void 0:s.id)||"",startDate:null,endDate:null,type:"paid",reason:""}),C({})}),[a,s]);const T=e=>{const{name:r,value:o}=e.target;j((e=>({...e,[r]:o}))),b[r]&&C((e=>({...e,[r]:null})))},z=(e,r)=>{j((o=>({...o,[e]:r}))),b[e]&&C((r=>({...r,[e]:null})))};return(0,g.useEffect)((()=>{if(D.startDate&&D.endDate){const e=new Date(D.startDate),r=new Date(D.endDate);if(r<e)return C((e=>({...e,endDate:"La date de fin doit \xeatre apr\xe8s la date de d\xe9but"}))),void B(0);const o=(0,re.Q$)(e,r);if(B(o),C((e=>({...e,endDate:null}))),"paid"===D.type||"rtt"===D.type){const e=J.y6.find((e=>e.value===D.type)),r=e?e.defaultQuota:0;S(o>r)}else S(!1)}else B(0),S(!1)}),[D.startDate,D.endDate,D.type]),(0,f.jsxs)(V.A,{open:o,onClose:t,maxWidth:"sm",fullWidth:!0,"aria-labelledby":"vacation-form-dialog-title",TransitionComponent:O.A,transitionDuration:400,PaperProps:{elevation:8,sx:{borderRadius:2,overflow:"hidden",transition:"all 0.3s ease",background:F?"#1F2937":"#FFFFFF"}},children:[(0,f.jsx)(oe,{id:"vacation-form-dialog-title",children:(0,f.jsx)(W.A,{in:o,timeout:500,children:(0,f.jsx)(x.A,{variant:"h6",component:"div",children:a?"\u270f\ufe0f Modifier la demande de cong\xe9":"\ud83c\udfd6\ufe0f Nouvelle demande de cong\xe9"})})}),(0,f.jsx)(te,{children:(0,f.jsx)(G.$,{dateAdapter:Y.h,adapterLocale:Z.A,children:(0,f.jsxs)(p.Ay,{container:!0,spacing:3,sx:{mt:1},children:[$&&(0,f.jsx)(p.Ay,{item:!0,xs:12,children:(0,f.jsx)(N.A,{direction:"right",in:o,timeout:500,children:(0,f.jsxs)(le,{fullWidth:!0,error:!!b.employeeId,children:[(0,f.jsxs)(_.A,{id:"employee-label",children:[(0,f.jsx)(E.A,{fontSize:"small",sx:{mr:1,verticalAlign:"middle"}}),"Employ\xe9"]}),(0,f.jsx)(L.A,{labelId:"employee-label",id:"employeeId",name:"employeeId",value:D.employeeId,onChange:T,label:"Employ\xe9",disabled:m,MenuProps:{PaperProps:{sx:{backgroundColor:F?"#1F2937":"#FFFFFF",color:F?"#D1D5DB":"inherit","& .MuiMenuItem-root":{color:F?"#D1D5DB":"inherit","&:hover":{backgroundColor:F?(0,i.X4)("#374151",.5):void 0},"&.Mui-selected":{backgroundColor:F?(0,i.X4)("#6366F1",.2):void 0,"&:hover":{backgroundColor:F?(0,i.X4)("#6366F1",.3):void 0}}}}}},children:u&&u.map((e=>(0,f.jsxs)(H.A,{value:e.id,children:[e.first_name," ",e.last_name]},e.id)))}),b.employeeId&&(0,f.jsx)(U.A,{sx:{color:F?"#F87171":void 0},children:b.employeeId})]})})}),(0,f.jsx)(p.Ay,{item:!0,xs:12,children:(0,f.jsx)(N.A,{direction:"right",in:o,timeout:600,children:(0,f.jsxs)(le,{fullWidth:!0,error:!!b.type,children:[(0,f.jsxs)(_.A,{id:"type-label",children:[(0,f.jsx)(I.A,{fontSize:"small",sx:{mr:1,verticalAlign:"middle"}}),"Type de cong\xe9"]}),(0,f.jsx)(L.A,{labelId:"type-label",id:"type",name:"type",value:D.type,onChange:T,label:"Type de cong\xe9",MenuProps:{PaperProps:{sx:{backgroundColor:F?"#1F2937":"#FFFFFF",color:F?"#D1D5DB":"inherit","& .MuiMenuItem-root":{color:F?"#D1D5DB":"inherit","&:hover":{backgroundColor:F?(0,i.X4)("#374151",.5):void 0},"&.Mui-selected":{backgroundColor:F?(0,i.X4)("#6366F1",.2):void 0,"&:hover":{backgroundColor:F?(0,i.X4)("#6366F1",.3):void 0}}}}}},children:J.y6.map((e=>(0,f.jsx)(H.A,{value:e.value,children:e.label},e.value)))}),b.type&&(0,f.jsx)(U.A,{sx:{color:F?"#F87171":void 0},children:b.type})]})})}),(0,f.jsx)(p.Ay,{item:!0,xs:12,sm:6,children:(0,f.jsx)(N.A,{direction:"right",in:o,timeout:700,children:(0,f.jsx)(l.A,{children:(0,f.jsx)(Q.l,{label:(0,f.jsxs)(l.A,{sx:{display:"flex",alignItems:"center"},children:[(0,f.jsx)(M.A,{fontSize:"small",sx:{mr:1}}),"Date de d\xe9but"]}),value:D.startDate,onChange:e=>z("startDate",e),slotProps:{textField:{fullWidth:!0,error:!!b.startDate,helperText:b.startDate,sx:{transition:"all 0.3s ease","& .MuiInputBase-root":{color:F?"#D1D5DB":void 0},"& .MuiInputLabel-root":{color:F?"#9CA3AF":void 0,backgroundColor:F?"#1F2937":"#FFFFFF",padding:"0 8px"},"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:F?"#4B5563":void 0},"&:hover fieldset":{borderColor:F?"#6B7280":void 0},"&.Mui-focused fieldset":{borderColor:F?"#6366F1":void 0}},"& .MuiFormHelperText-root":{color:F&&b.startDate?"#F87171":void 0},"&:hover":{transform:"translateY(-2px)",boxShadow:F?`0 4px 8px ${(0,i.X4)("#000",.3)}`:`0 4px 8px ${(0,i.X4)("#000",.1)}`}}},popper:{sx:{"& .MuiPaper-root":{backgroundColor:F?"#1F2937":"#FFFFFF",color:F?"#D1D5DB":"inherit","& .MuiPickersDay-root":{color:F?"#D1D5DB":void 0,"&:hover":{backgroundColor:F?(0,i.X4)("#374151",.5):void 0},"&.Mui-selected":{backgroundColor:F?"#6366F1":void 0,color:"#FFFFFF"}}}}}}})})})}),(0,f.jsx)(p.Ay,{item:!0,xs:12,sm:6,children:(0,f.jsx)(N.A,{direction:"left",in:o,timeout:700,children:(0,f.jsx)(l.A,{children:(0,f.jsx)(Q.l,{label:(0,f.jsxs)(l.A,{sx:{display:"flex",alignItems:"center"},children:[(0,f.jsx)(M.A,{fontSize:"small",sx:{mr:1}}),"Date de fin"]}),value:D.endDate,onChange:e=>z("endDate",e),slotProps:{textField:{fullWidth:!0,error:!!b.endDate,helperText:b.endDate,sx:{transition:"all 0.3s ease","& .MuiInputBase-root":{color:F?"#D1D5DB":void 0},"& .MuiInputLabel-root":{color:F?"#9CA3AF":void 0,backgroundColor:F?"#1F2937":"#FFFFFF",padding:"0 8px"},"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:F?"#4B5563":void 0},"&:hover fieldset":{borderColor:F?"#6B7280":void 0},"&.Mui-focused fieldset":{borderColor:F?"#6366F1":void 0}},"& .MuiFormHelperText-root":{color:F&&b.endDate?"#F87171":void 0},"&:hover":{transform:"translateY(-2px)",boxShadow:F?`0 4px 8px ${(0,i.X4)("#000",.3)}`:`0 4px 8px ${(0,i.X4)("#000",.1)}`}}},popper:{sx:{"& .MuiPaper-root":{backgroundColor:F?"#1F2937":"#FFFFFF",color:F?"#D1D5DB":"inherit","& .MuiPickersDay-root":{color:F?"#D1D5DB":void 0,"&:hover":{backgroundColor:F?(0,i.X4)("#374151",.5):void 0},"&.Mui-selected":{backgroundColor:F?"#6366F1":void 0,color:"#FFFFFF"}}}}}}})})})}),k>0&&(0,f.jsx)(p.Ay,{item:!0,xs:12,children:(0,f.jsx)(W.A,{in:k>0,timeout:800,children:(0,f.jsxs)(l.A,{sx:{display:"flex",justifyContent:"center",my:1},children:[(0,f.jsx)(ae,{icon:(0,f.jsx)(w.A,{}),label:`Dur\xe9e: ${k} jour${k>1?"s":""} ouvr\xe9${k>1?"s":""}`}),X&&(0,f.jsx)(se,{color:"warning",label:"Quota d\xe9pass\xe9",sx:{ml:1}})]})})}),(0,f.jsx)(p.Ay,{item:!0,xs:12,children:(0,f.jsx)(N.A,{direction:"up",in:o,timeout:800,children:(0,f.jsx)(q.A,{id:"reason",name:"reason",label:"Motif (optionnel)",multiline:!0,rows:3,fullWidth:!0,value:D.reason,onChange:T,error:!!b.reason,helperText:b.reason,sx:{transition:"all 0.3s ease","& .MuiInputBase-root":{color:F?"#D1D5DB":void 0},"& .MuiInputLabel-root":{color:F?"#9CA3AF":void 0,backgroundColor:F?"#1F2937":"#FFFFFF",padding:"0 8px"},"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:F?"#4B5563":void 0},"&:hover fieldset":{borderColor:F?"#6B7280":void 0},"&.Mui-focused fieldset":{borderColor:F?"#6366F1":void 0}},"& .MuiFormHelperText-root":{color:F&&b.reason?"#F87171":void 0},"&:hover":{transform:"translateY(-2px)",boxShadow:F?`0 4px 8px ${(0,i.X4)("#000",.3)}`:`0 4px 8px ${(0,i.X4)("#000",.1)}`}}})})})]})})}),(0,f.jsxs)(ne,{children:[(0,f.jsx)(h.A,{onClick:t,sx:{transition:"all 0.2s ease",color:F?"#D1D5DB":void 0,"&:hover":{transform:"scale(1.05)",color:F?"#FFFFFF":void 0}},children:"Annuler"}),(0,f.jsx)(h.A,{onClick:()=>{if((()=>{const e={};return D.employeeId||(e.employeeId="L'identifiant de l'employ\xe9 est requis"),D.startDate||(e.startDate="La date de d\xe9but est requise"),D.endDate||(e.endDate="La date de fin est requise"),D.startDate&&D.endDate&&D.startDate>D.endDate&&(e.endDate="La date de fin doit \xeatre post\xe9rieure \xe0 la date de d\xe9but"),C(e),0===Object.keys(e).length})()){const e={...D,startDate:D.startDate?D.startDate.toISOString().split("T")[0]:null,endDate:D.endDate?D.endDate.toISOString().split("T")[0]:null};n(e)}},variant:"contained",color:"primary",sx:{transition:"all 0.2s ease","&:hover":{transform:"scale(1.05)"}},children:a?"Mettre \xe0 jour":"Cr\xe9er"})]})]})};var de=o(8606),ce=o(3392),ue=o(8171),pe=o(9540),me=o(8645),xe=o(3560),he=o(6625),ve=o(9650),Ae=o(4882),Fe=o(8076),ge=o(39),De=o(7392),ye=o(1806),je=o(8093),be=o(3460),fe=o(7739),Ce=o(2598),ke=o(9525);const Be=(0,t.A)(ve.A)((e=>{var r,o;let{theme:t}=e;const{theme:n}=(0,y.D)(),a="dark"===(null===t||void 0===t||null===(r=t.palette)||void 0===r?void 0:r.mode)||"dark"===n;return{borderRadius:(null===t||void 0===t||null===(o=t.shape)||void 0===o?void 0:o.borderRadius)||8,boxShadow:a?`0 4px 20px ${(0,i.X4)("#000",.3)}`:`0 2px 10px ${(0,i.X4)("#000",.1)}`,overflow:"hidden",transition:"all 0.3s ease",background:a?"#1F2937":"#FFFFFF","&:hover":{boxShadow:a?`0 8px 25px ${(0,i.X4)("#000",.4)}`:`0 4px 15px ${(0,i.X4)("#000",.15)}`}}})),Xe=(0,t.A)(Ae.A)((e=>{var r;let{theme:o}=e;const{theme:t}=(0,y.D)(),n="dark"===(null===o||void 0===o||null===(r=o.palette)||void 0===r?void 0:r.mode)||"dark"===t;return{background:n?(0,i.X4)("#6366F1",.15):(0,i.X4)("#4F46E5",.05),"& th":{fontWeight:600,color:n?"#D1D5DB":"#111827",borderBottom:`2px solid ${n?(0,i.X4)("#6366F1",.3):(0,i.X4)("#4F46E5",.2)}`}}})),Se=(0,t.A)(Fe.A)((e=>{var r;let{theme:o}=e;const{theme:t}=(0,y.D)(),n="dark"===(null===o||void 0===o||null===(r=o.palette)||void 0===r?void 0:r.mode)||"dark"===t;return{transition:"all 0.2s ease","&:nth-of-type(odd)":{backgroundColor:n?(0,i.X4)("#374151",.3):(0,i.X4)("#F3F4F6",.5)},"&:hover":{backgroundColor:n?(0,i.X4)("#4B5563",.4):(0,i.X4)("#E5E7EB",.7),transform:"translateY(-2px)",boxShadow:n?`0 4px 8px ${(0,i.X4)("#000",.3)}`:`0 2px 5px ${(0,i.X4)("#000",.1)}`},"&:last-child td, &:last-child th":{border:0}}})),Ee=(0,t.A)(ge.A)((e=>{var r,o;let{theme:t}=e;const{theme:n}=(0,y.D)(),a="dark"===(null===t||void 0===t||null===(r=t.palette)||void 0===r?void 0:r.mode)||"dark"===n;return{padding:(null===t||void 0===t||null===(o=t.spacing)||void 0===o?void 0:o.call(t,1.5))||"12px",color:a?"#D1D5DB":"inherit",borderColor:a?(0,i.X4)("#4B5563",.5):void 0}})),Ie=(0,t.A)(z.A)((e=>{var r;let{status:o,theme:t}=e;const{theme:n}=(0,y.D)(),a="dark"===(null===t||void 0===t||null===(r=t.palette)||void 0===r?void 0:r.mode)||"dark"===n;let s={pending:{bg:a?(0,i.X4)("#F59E0B",.2):(0,i.X4)("#F59E0B",.1),color:a?"#FBBF24":"#D97706",border:a?(0,i.X4)("#F59E0B",.3):(0,i.X4)("#F59E0B",.2)},approved:{bg:a?(0,i.X4)("#10B981",.2):(0,i.X4)("#10B981",.1),color:a?"#34D399":"#059669",border:a?(0,i.X4)("#10B981",.3):(0,i.X4)("#10B981",.2)},rejected:{bg:a?(0,i.X4)("#EF4444",.2):(0,i.X4)("#EF4444",.1),color:a?"#F87171":"#DC2626",border:a?(0,i.X4)("#EF4444",.3):(0,i.X4)("#EF4444",.2)}};const l=s[o]||s.pending;return{backgroundColor:l.bg,color:l.color,border:`1px solid ${l.border}`,fontWeight:500,transition:"all 0.3s ease","& .MuiChip-icon":{color:"inherit"}}})),Me=(0,t.A)(De.A)((e=>{var r;let{$actionType:o,theme:t}=e;const{theme:n}=(0,y.D)(),a="dark"===(null===t||void 0===t||null===(r=t.palette)||void 0===r?void 0:r.mode)||"dark"===n;let s={edit:{color:a?"#60A5FA":"#3B82F6",hoverBg:a?(0,i.X4)("#3B82F6",.2):(0,i.X4)("#3B82F6",.1)},delete:{color:a?"#F87171":"#EF4444",hoverBg:a?(0,i.X4)("#EF4444",.2):(0,i.X4)("#EF4444",.1)},approve:{color:a?"#34D399":"#10B981",hoverBg:a?(0,i.X4)("#10B981",.2):(0,i.X4)("#10B981",.1)},reject:{color:a?"#F87171":"#EF4444",hoverBg:a?(0,i.X4)("#EF4444",.2):(0,i.X4)("#EF4444",.1)}};const l=s[o]||s.edit;return{color:l.color,transition:"all 0.2s ease","&:hover":{backgroundColor:l.hoverBg,transform:"scale(1.1)"}}})),we=(0,t.A)(l.A)((e=>{var r,o,t;let{theme:n}=e;const{theme:a}=(0,y.D)(),s="dark"===(null===n||void 0===n||null===(r=n.palette)||void 0===r?void 0:r.mode)||"dark"===a;return{padding:(null===n||void 0===n||null===(o=n.spacing)||void 0===o?void 0:o.call(n,4))||"32px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"200px",backgroundColor:s?(0,i.X4)("#1F2937",.7):(0,i.X4)("#F9FAFB",.7),borderRadius:(null===n||void 0===n||null===(t=n.shape)||void 0===t?void 0:t.borderRadius)||8,border:"1px dashed "+(s?"#4B5563":"#D1D5DB"),color:s?"#9CA3AF":"#6B7280"}})),$e=e=>{let{vacations:r,loading:o,onEdit:t,onDelete:n,onApprove:a,onReject:s,onCreateNew:i}=e;const{user:d}=(0,K.A)(),{theme:c}=(0,y.D)(),u="dark"===c,[p,h]=(0,g.useState)(0),[v,A]=(0,g.useState)(10),[D,j]=(0,g.useState)("asc"),[b,C]=(0,g.useState)("startDate"),k=d&&"admin"===d.role,B=e=>{j(b===e&&"asc"===D?"desc":"asc"),C(e)},X=(0,g.useCallback)(((e,r,o,t)=>{if("employee"===o){const o=e.employee?`${e.employee.first_name||""} ${e.employee.last_name||""}`.trim():e.employeeName||"",n=r.employee?`${r.employee.first_name||""} ${r.employee.last_name||""}`.trim():r.employeeName||"";return"asc"===t?o.localeCompare(n):n.localeCompare(o)}const n=null===e[o]||void 0===e[o]?"":e[o],a=null===r[o]||void 0===r[o]?"":r[o];if("startDate"===o||"endDate"===o){const e=n?new Date(n).getTime():0,r=a?new Date(a).getTime():0;return"asc"===t?e-r:r-e}return"string"===typeof n&&"string"===typeof a?"asc"===t?n.localeCompare(a):a.localeCompare(n):"asc"===t?n-a:a-n}),[]),S=(0,g.useMemo)((()=>{const e={};return Array.isArray(J.y6)&&J.y6.forEach((r=>{e[r.value]=r.label})),r=>{if(e[r])return e[r];switch(r){case"paid":return"Cong\xe9 pay\xe9";case"unpaid":return"Cong\xe9 sans solde";case"sick":return"Cong\xe9 maladie";case"parental":return"Cong\xe9 parental";case"other":return"Autre";default:return r}}}),[]),E=(0,g.useMemo)((()=>{const e={[J.D1.PENDING]:"En attente",[J.D1.APPROVED]:"Approuv\xe9",[J.D1.REJECTED]:"Rejet\xe9"};return r=>e[r]||r}),[]),I=(0,g.useMemo)((()=>{const e={approved:(0,f.jsx)(de.A,{fontSize:"small"}),rejected:(0,f.jsx)(ce.A,{fontSize:"small"}),pending:(0,f.jsx)(ue.A,{fontSize:"small"})};return r=>e[r]||e.pending}),[]),M=(0,g.useCallback)((e=>{if(!e)return"-";try{return(0,ke.A)(new Date(e),"dd MMMM yyyy",{locale:Z.A})}catch(r){return console.error("Erreur de formatage de la date:",r),e||"-"}}),[]),w=(0,g.useMemo)((()=>r?[...r].sort(((e,r)=>X(e,r,b,D))):[]),[r,b,D,X]).slice(p*v,p*v+v);return(0,f.jsx)(l.A,{sx:{width:"100%"},children:(0,f.jsx)(W.A,{in:!0,timeout:800,children:(0,f.jsx)(Be,{component:m.A,children:o?(0,f.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",p:4,minHeight:300},children:(0,f.jsx)(F.A,{color:"primary",sx:{color:u?"#6366F1":void 0}})}):r&&r.length>0?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(ye.A,{sx:{minWidth:650},"aria-label":"tableau des cong\xe9s",children:[(0,f.jsx)(Xe,{children:(0,f.jsxs)(Fe.A,{children:[(0,f.jsx)(Ee,{children:(0,f.jsx)(je.A,{active:"employee"===b,direction:"employee"===b?D:"asc",onClick:()=>B("employee"),IconComponent:"employee"===b?"asc"===D?pe.A:me.A:void 0,children:"Employ\xe9"})}),(0,f.jsx)(Ee,{children:(0,f.jsx)(je.A,{active:"type"===b,direction:"type"===b?D:"asc",onClick:()=>B("type"),IconComponent:"type"===b?"asc"===D?pe.A:me.A:void 0,children:"Type"})}),(0,f.jsx)(Ee,{children:(0,f.jsx)(je.A,{active:"startDate"===b,direction:"startDate"===b?D:"asc",onClick:()=>B("startDate"),IconComponent:"startDate"===b?"asc"===D?pe.A:me.A:void 0,children:"Date de d\xe9but"})}),(0,f.jsx)(Ee,{children:(0,f.jsx)(je.A,{active:"endDate"===b,direction:"endDate"===b?D:"asc",onClick:()=>B("endDate"),IconComponent:"endDate"===b?"asc"===D?pe.A:me.A:void 0,children:"Date de fin"})}),(0,f.jsx)(Ee,{children:(0,f.jsx)(je.A,{active:"status"===b,direction:"status"===b?D:"asc",onClick:()=>B("status"),IconComponent:"status"===b?"asc"===D?pe.A:me.A:void 0,children:"Statut"})}),(0,f.jsx)(Ee,{align:"right",children:"Actions"})]})}),(0,f.jsx)(be.A,{children:w.map((e=>(0,f.jsx)(O.A,{in:!0,style:{transitionDelay:50*w.indexOf(e)+"ms"},children:(0,f.jsxs)(Se,{children:[(0,f.jsx)(Ee,{component:"th",scope:"row",children:e.employee?`${e.employee.first_name||""} ${e.employee.last_name||""}`.trim():e.employeeName||e.employee_name||"-"}),(0,f.jsx)(Ee,{children:S(e.type)}),(0,f.jsx)(Ee,{children:M(e.startDate||e.start_date)}),(0,f.jsx)(Ee,{children:M(e.endDate||e.end_date)}),(0,f.jsx)(Ee,{children:(0,f.jsx)(Ie,{icon:I(e.status),label:E(e.status),status:e.status,size:"small"})}),(0,f.jsx)(Ee,{align:"right",children:(0,f.jsxs)(l.A,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:[k&&"pending"===e.status&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(fe.A,{title:"Approuver",children:(0,f.jsx)(Me,{size:"small",onClick:()=>a(e.id),$actionType:"approve",children:(0,f.jsx)(de.A,{fontSize:"small"})})}),(0,f.jsx)(fe.A,{title:"Rejeter",children:(0,f.jsx)(Me,{size:"small",onClick:()=>s(e.id),$actionType:"reject",children:(0,f.jsx)(ce.A,{fontSize:"small"})})})]}),(k||e.employeeId===(null===d||void 0===d?void 0:d.id))&&(0,f.jsx)(fe.A,{title:"Modifier",children:(0,f.jsx)(Me,{size:"small",onClick:()=>t(e),$actionType:"edit",children:(0,f.jsx)(xe.A,{fontSize:"small"})})}),(k||e.employeeId===(null===d||void 0===d?void 0:d.id))&&(0,f.jsx)(fe.A,{title:"Supprimer",children:(0,f.jsx)(Me,{size:"small",onClick:()=>n(e.id),$actionType:"delete",children:(0,f.jsx)(he.A,{fontSize:"small"})})})]})})]})},e.id)))})]}),(0,f.jsx)(Ce.A,{rowsPerPageOptions:[5,10,25],component:"div",count:r.length,rowsPerPage:v,page:p,onPageChange:(e,r)=>{h(r)},onRowsPerPageChange:e=>{A(parseInt(e.target.value,10)),h(0)},sx:{color:u?"#D1D5DB":"inherit","& .MuiToolbar-root":{color:u?"#D1D5DB":"inherit"},"& .MuiSvgIcon-root":{color:u?"#9CA3AF":void 0}}})]}):(0,f.jsxs)(we,{children:[(0,f.jsx)(x.A,{variant:"h6",sx:{mb:2,color:"inherit"},children:"Aucune demande de cong\xe9"}),(0,f.jsx)(x.A,{variant:"body2",sx:{mb:3,textAlign:"center"},children:"Il n'y a pas encore de demandes de cong\xe9s. Cr\xe9ez-en une nouvelle en cliquant sur le bouton ci-dessus."})]})})})})};var Re=o(290);const Te=(0,t.A)(l.A)((e=>{var r;let{theme:o}=e;const{theme:t}=(0,y.D)(),n="dark"===(null===o||void 0===o||null===(r=o.palette)||void 0===r?void 0:r.mode)||"dark"===t;return{display:"flex",alignItems:"center",justifyContent:"center",width:"80px",height:"80px",borderRadius:"50%",background:n?`linear-gradient(135deg, ${(0,i.X4)("#6366F1",.2)}, ${(0,i.X4)("#60A5FA",.4)})`:`linear-gradient(135deg, ${(0,i.X4)("#4F46E5",.1)}, ${(0,i.X4)("#3B82F6",.3)})`,boxShadow:n?`0 4px 20px ${(0,i.X4)("#000",.25)}`:`0 4px 15px ${(0,i.X4)("#000",.08)}`,color:n?"#93C5FD":"#4F46E5",flexShrink:0,transition:"all 0.3s ease","& .MuiSvgIcon-root":{fontSize:40}}})),ze=()=>{var e;const r=(0,d.A)(),o=(0,c.A)(r.breakpoints.down("md")),[t,j]=(0,g.useState)(0),[b,B]=(0,g.useState)(!1),[X,E]=(0,g.useState)(null),[I,M]=(0,g.useState)(!1),{user:w}=(0,K.A)(),{vacations:$,loading:R,error:T,createVacation:z,updateVacation:P,deleteVacation:V,updateVacationStatus:O,getVacationsByStatus:W,refreshVacations:N}=(0,Re.A)(),{theme:_}=(0,y.D)(),L="dark"===(null===r||void 0===r||null===(e=r.palette)||void 0===e?void 0:e.mode)||"dark"===_,H=()=>{E(null),B(!0)},U=()=>{B(!1),E(null)},q=(0,g.useMemo)((()=>{switch(t){case 0:default:return $;case 1:return W("pending");case 2:return W("approved");case 3:return W("rejected")}}),[$,t,W]);return R&&!I?(0,f.jsx)(k,{message:"Chargement des cong\xe9s..."}):T&&!I?(0,f.jsx)(C,{message:T}):(0,f.jsxs)(u.A,{maxWidth:"xl",sx:{mt:4,mb:4},children:[(0,f.jsx)(S,{title:"Gestion des cong\xe9s",subtitle:"Consultez et g\xe9rez les demandes de cong\xe9s",icon:(0,f.jsx)(Te,{children:(0,f.jsx)(n.A,{})})}),(0,f.jsx)(p.Ay,{container:!0,spacing:3,children:(0,f.jsx)(p.Ay,{item:!0,xs:12,children:(0,f.jsxs)(m.A,{elevation:3,sx:{p:3,mb:3,backgroundColor:L?"#1F2937":"#FFFFFF",color:L?"#D1D5DB":"inherit",borderRadius:2,boxShadow:L?`0 4px 20px ${(0,i.X4)("#000",.4)}`:`0 4px 20px ${(0,i.X4)("#000",.1)}`},children:[(0,f.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,f.jsx)(x.A,{variant:"h5",color:L?"#F9FAFB":"inherit",children:"Liste des demandes de cong\xe9s"}),(0,f.jsxs)(l.A,{children:[(0,f.jsx)(h.A,{variant:"outlined",color:"primary",startIcon:(0,f.jsx)(a.A,{}),onClick:async()=>{M(!0);try{await N(),D.oR.success("Donn\xe9es des cong\xe9s rafra\xeechies")}catch(T){console.error("Erreur lors du rafra\xeechissement des donn\xe9es:",T),D.oR.error("Erreur lors du rafra\xeechissement des donn\xe9es")}finally{M(!1)}},disabled:I,sx:{mr:1,color:L?"#F9FAFB":void 0,borderColor:L?"#6366F1":void 0,"&:hover":{borderColor:L?"#818CF8":void 0}},children:I?"Rafra\xeechissement...":"Rafra\xeechir"}),(0,f.jsx)(h.A,{variant:"contained",color:"primary",startIcon:(0,f.jsx)(s.A,{}),onClick:H,sx:{transition:"all 0.2s ease","&:hover":{transform:"scale(1.05)"}},children:"Nouvelle demande"})]})]}),(0,f.jsxs)(v.A,{value:t,onChange:(e,r)=>{j(r)},indicatorColor:"primary",textColor:"primary",variant:o?"scrollable":"fullWidth",scrollButtons:!!o&&"auto",sx:{mb:2,"& .MuiTab-root":{color:L?"#9CA3AF":void 0,"&.Mui-selected":{color:L?"#F9FAFB":void 0}},"& .MuiTabs-indicator":{backgroundColor:L?"#6366F1":void 0}},children:[(0,f.jsx)(A.A,{label:"Tous"}),(0,f.jsx)(A.A,{label:"En attente"}),(0,f.jsx)(A.A,{label:"Approuv\xe9s"}),(0,f.jsx)(A.A,{label:"Rejet\xe9s"})]}),R&&I?(0,f.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",p:3},children:(0,f.jsx)(F.A,{})}):(0,f.jsx)($e,{vacations:q,loading:R||I,onEdit:e=>{E(e),B(!0)},onDelete:async e=>{try{await V(e)}catch(T){console.error("Erreur lors de la suppression du cong\xe9:",T),D.oR.error("Une erreur est survenue lors de la suppression du cong\xe9")}},onApprove:async e=>{try{await O(e,"approved")}catch(T){console.error("Erreur lors de l'approbation du cong\xe9:",T),D.oR.error("Une erreur est survenue lors de l'approbation du cong\xe9")}},onReject:async(e,r)=>{try{await O(e,"rejected",r)}catch(T){console.error("Erreur lors du rejet du cong\xe9:",T),D.oR.error("Une erreur est survenue lors du rejet du cong\xe9")}},onCreateNew:H})]})})}),(0,f.jsx)(ie,{open:b,onClose:U,onSubmit:async e=>{try{X?await P(X.id,e):await z(e),U()}catch(T){console.error("Erreur lors de la soumission du formulaire:",T),D.oR.error("Une erreur est survenue lors de la soumission du formulaire")}},vacation:X,currentUser:w})]})}}}]);
//# sourceMappingURL=351.08b4970a.chunk.js.map